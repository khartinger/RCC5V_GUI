{"remainingRequest":"G:\\work3\\vue\\haus2\\node_modules\\thread-loader\\dist\\cjs.js!G:\\work3\\vue\\haus2\\node_modules\\ts-loader\\index.js??ref--13-2!G:\\work3\\vue\\haus2\\src\\services\\CiMqttClient.ts","dependencies":[{"path":"G:\\work3\\vue\\haus2\\src\\services\\CiMqttClient.ts","mtime":1640693899479},{"path":"G:\\work3\\vue\\haus2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus2\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus2\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IG1xdHQgZnJvbSAnbXF0dCc7DQppbXBvcnQgeyByZWFjdGl2ZSwgcmVhZG9ubHkgfSBmcm9tICd2dWUnOw0KLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KLy8gY2xhc3MgQ2lNcXR0Q2xpZW50DQovLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQp2YXIgQ2lNcXR0Q2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgew0KICAgIC8vID09PT09PT09PW1ldGhvZHM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogICAgLy8gX19fX19fX19fY29uc3RydWN0b3JfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18NCiAgICBmdW5jdGlvbiBDaU1xdHRDbGllbnQoY29ubmVjdE9uU3RhcnQpIHsNCiAgICAgICAgLy8gLS0tLS0tLS0tYmFzaWMgcHJvcGVydGllcy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgdGhpcy5jbGllbnQgPSBudWxsOw0KICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBbXTsNCiAgICAgICAgdGhpcy5zdWJUb3BpYyA9ICcjJzsNCiAgICAgICAgdGhpcy5zdWJRb3MgPSAwOw0KICAgICAgICAvLyAtLS0tLS0tLS1zb21lIG1vcmUgcHJvcGVydGllcyAoaW50ZXJmYWNlcyktLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAvLyBUbyBwcmV2ZW50IHZhbHVlcyBmcm9tIGJlaW5nIGNoYW5nZWQgYnkgbWlzdGFrZSwNCiAgICAgICAgLy8gdGhlcmUgaXMgYWx3YXlzIGEgcHJpdmF0ZSBhbmQgYSBwdWJsaWMgdmFyaWFudC4NCiAgICAgICAgdGhpcy5wcml2YXRlTXF0dFN0YXRlID0gcmVhY3RpdmUoew0KICAgICAgICAgICAgY29ubmVjdE9uU3RhcnQ6IGZhbHNlLA0KICAgICAgICAgICAgY29ubmVjdGVkOiBmYWxzZSwNCiAgICAgICAgICAgIGlDb25uTXF0dFN0YXRlOiAtMSwNCiAgICAgICAgICAgIG1lc3NhZ2U6IHsgdG9waWM6ICcnLCBwYXlsb2FkOiAnJywgcmV0YWluOiBmYWxzZSwgcW9zOiAwIH0NCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMubXF0dFN0YXRlID0gcmVhZG9ubHkodGhpcy5wcml2YXRlTXF0dFN0YXRlKTsNCiAgICAgICAgdGhpcy5wcml2YXRlTXF0dENvbm5lY3Rpb24gPSByZWFjdGl2ZSh7DQogICAgICAgICAgICBob3N0OiAnMTkyLjE2OC4wLjcnLA0KICAgICAgICAgICAgcG9ydDogMTg4NCwNCiAgICAgICAgICAgIGVuZHBvaW50OiAnJywNCiAgICAgICAgICAgIGNsZWFuOiB0cnVlLA0KICAgICAgICAgICAgY29ubmVjdFRpbWVvdXQ6IDQwMDAsDQogICAgICAgICAgICByZWNvbm5lY3RQZXJpb2Q6IDQwMDAsDQogICAgICAgICAgICBjbGllbnRJZDogJycsDQogICAgICAgICAgICB1c2VybmFtZTogJycsDQogICAgICAgICAgICBwYXNzd29yZDogJycNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMubXF0dENvbm5lY3Rpb24gPSByZWFkb25seSh0aGlzLnByaXZhdGVNcXR0Q29ubmVjdGlvbik7DQogICAgICAgIHRoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24gPSByZWFjdGl2ZSh7DQogICAgICAgICAgICB0b3BpYzogJyMnLA0KICAgICAgICAgICAgcW9zOiAwLA0KICAgICAgICAgICAgc3Vic2NyaWJlZDogZmFsc2UNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMubXF0dFN1YnNjcmlwdGlvbiA9IHJlYWRvbmx5KHRoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24pOw0KICAgICAgICB0aGlzLnByaXZhdGVNcXR0U3RhdGUuY29ubmVjdE9uU3RhcnQgPSBjb25uZWN0T25TdGFydDsNCiAgICAgICAgY29uc29sZS5sb2coJ01xdHRDbGllbnQtQ29uc3RydWN0b3I6IHByaXZhdGVNcXR0U3RhdGUuY29ubmVjdE9uU3RhcnQgPSAnLCB0aGlzLnByaXZhdGVNcXR0U3RhdGUuY29ubmVjdE9uU3RhcnQpOw0KICAgICAgICBpZiAodGhpcy5wcml2YXRlTXF0dFN0YXRlLmNvbm5lY3RPblN0YXJ0KSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnTXF0dENsaWVudC1Db25zdHJ1Y3RvcjogY29ubmVjdGluZyB0byAnICsgdGhpcy5jb25uZWN0VXJsKCkpOw0KICAgICAgICAgICAgdGhpcy5jb25uZWN0XygpOw0KICAgICAgICAgICAgdGhpcy5zdWJUb3BpYyA9IHRoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24udG9waWM7DQogICAgICAgICAgICB0aGlzLnN1YlFvcyA9IHRoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24ucW9zOw0KICAgICAgICAgICAgY29uc29sZS5sb2coJ01xdHRDbGllbnQtQ29uc3RydWN0b3I6IHN1YnNjcmliZSAnICsgdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYyk7DQogICAgICAgICAgICB0aGlzLnN1YnNjcmliZV8oKTsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNcXR0Q2xpZW50LUNvbnN0cnVjdG9yOiBmaW5pc2hlZCcpOw0KICAgICAgICB9DQogICAgfQ0KICAgIC8vIF9fX19fX19fX2Nvbm5lY3QgdXJsIGxpa2UgMTAuMS4xLjE6MTg4NF9fX19fX19fX19fX19fX19fX19fDQogICAgQ2lNcXR0Q2xpZW50LnByb3RvdHlwZS5jb25uZWN0VXJsID0gZnVuY3Rpb24gKCkgew0KICAgICAgICByZXR1cm4gIndzOi8vIiArIHRoaXMubXF0dENvbm5lY3Rpb24uaG9zdCArICI6IiArIHRoaXMubXF0dENvbm5lY3Rpb24ucG9ydCArIHRoaXMubXF0dENvbm5lY3Rpb24uZW5kcG9pbnQ7DQogICAgfTsNCiAgICAvLyBfX19fX19fX19wdWJsaWMgdmFyaWFudDogY29ubmVjdCB0byBzZXJ2ZXIgKGJyb2tlcilfX19fX19fXw0KICAgIENpTXF0dENsaWVudC5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIChob3N0LCBwb3J0LCBlbmRwb2ludCkgew0KICAgICAgICB0aGlzLnByaXZhdGVNcXR0Q29ubmVjdGlvbi5ob3N0ID0gaG9zdDsNCiAgICAgICAgdGhpcy5wcml2YXRlTXF0dENvbm5lY3Rpb24ucG9ydCA9IHBvcnQ7DQogICAgICAgIHRoaXMucHJpdmF0ZU1xdHRDb25uZWN0aW9uLmVuZHBvaW50ID0gZW5kcG9pbnQ7DQogICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3RfKCk7DQogICAgfTsNCiAgICAvLyBfX19fX19fX19wcml2YXRlIHZhcmlhbnQ6IGNvbm5lY3QgdG8gc2VydmVyIChicm9rZXIpX19fX19fXw0KICAgIENpTXF0dENsaWVudC5wcm90b3R5cGUuY29ubmVjdF8gPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBpZiAoX3RoaXMuY2xpZW50KQ0KICAgICAgICAgICAgICAgIF90aGlzLmRpc2Nvbm5lY3QoKTsNCiAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuaUNvbm5NcXR0U3RhdGUgPSAyOw0KICAgICAgICAgICAgdmFyIG9wdGlvbnNfID0gew0KICAgICAgICAgICAgICAgIGNsZWFuOiBfdGhpcy5tcXR0Q29ubmVjdGlvbi5jbGVhbiwNCiAgICAgICAgICAgICAgICBjb25uZWN0VGltZW91dDogX3RoaXMubXF0dENvbm5lY3Rpb24uY29ubmVjdFRpbWVvdXQsDQogICAgICAgICAgICAgICAgcmVjb25uZWN0UGVyaW9kOiBfdGhpcy5tcXR0Q29ubmVjdGlvbi5yZWNvbm5lY3RQZXJpb2QsDQogICAgICAgICAgICAgICAgY2xpZW50SWQ6IF90aGlzLm1xdHRDb25uZWN0aW9uLmNsaWVudElkLA0KICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBfdGhpcy5tcXR0Q29ubmVjdGlvbi51c2VybmFtZSwNCiAgICAgICAgICAgICAgICBwYXNzd29yZDogX3RoaXMubXF0dENvbm5lY3Rpb24ucGFzc3dvcmQNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICBjb25zb2xlLmxvZygnTXF0dENpZW50LnRzLWNvbm5lY3Q6IHVybD0nICsgX3RoaXMuY29ubmVjdFVybCgpKTsNCiAgICAgICAgICAgIHZhciBjbGllbnQgPSBtcXR0LmNvbm5lY3QoX3RoaXMuY29ubmVjdFVybCgpLCBvcHRpb25zXyk7DQogICAgICAgICAgICBfdGhpcy5jbGllbnQgPSBjbGllbnQ7DQogICAgICAgICAgICBfdGhpcy5jbGllbnQub24oJ2Nvbm5lY3QnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdGF0ZS5jb25uZWN0ZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuaUNvbm5NcXR0U3RhdGUgPSAxOw0KICAgICAgICAgICAgICAgIGNsaWVudC5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01RVFQgRXJyb3InLCBlcnIpOw0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmlDb25uTXF0dFN0YXRlID0gNzsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBjbGllbnQub24oJ2Nvbm5lY3RpbmcnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01RVFQgQ29ubmVjdGluZycpOw0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmlDb25uTXF0dFN0YXRlID0gMjsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBjbGllbnQub24oJ29mZmxpbmUnLCBmdW5jdGlvbiAodmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdGF0ZS5jb25uZWN0ZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24uc3Vic2NyaWJlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNUVRUIE9mZmxpbmUnLCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuaUNvbm5NcXR0U3RhdGUgPSAzOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGNsaWVudC5vbignZGlzY29ubmVjdCcsIGZ1bmN0aW9uICh2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNUVRUIERpc2Nvbm5lY3QnLCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuaUNvbm5NcXR0U3RhdGUgPSAwOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGNsaWVudC5vbignZW5kJywgZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuY29ubmVjdGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnN1YnNjcmliZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTXF0dENsaWVudC50cy1lbmQ6IHZhbHVlPScsIHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdGF0ZS5pQ29ubk1xdHRTdGF0ZSA9IDk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgY2xpZW50Lm9uKCdtZXNzYWdlJywgZnVuY3Rpb24gKHRvcGljLCBwYXlsb2FkLCBwcm9wczEpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJldGFpbjEgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldGFpbjEgPSBwcm9wczEucmV0YWluOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFyIHFvczEgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcW9zMSA9IHByb3BzMS5xb3M7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5jb250cm9sbGVyLmZvckVhY2goZnVuY3Rpb24gKGNvbnRyb2xsZXIpIHsgcmV0dXJuIGNvbnRyb2xsZXIub25NZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvcGljOiB0b3BpYywNCiAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQ6IHBheWxvYWQudG9TdHJpbmcoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldGFpbjogcmV0YWluMSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHFvczogcW9zMQ0KICAgICAgICAgICAgICAgICAgICB9KTsgfSk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgcmVzb2x2ZSgpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBjbGllbnQub24oJ2Vycm9yJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG9uIGNvbm5lY3RpbmcuLi4nKTsNCiAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmlDb25uTXF0dFN0YXRlID0gODsNCiAgICAgICAgICAgICAgICByZWplY3QoRXJyb3IoJ0Vycm9yJykpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgIH07DQogICAgLy8gX19fX19fX19fZGlzY29ubmVjdCBmcm9tIGJyb2tlcl9fX19fX19fX19fX19fX19fX19fX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBpZiAoIV90aGlzLmNsaWVudCkNCiAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignTm90IENvbm5lY3RlZCcpKTsNCiAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuaUNvbm5NcXR0U3RhdGUgPSA5Ow0KICAgICAgICAgICAgX3RoaXMuY2xpZW50LmVuZCh0cnVlLCB7fSwgZnVuY3Rpb24gKGVycikgew0KICAgICAgICAgICAgICAgIGlmIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpTXF0dENsaWVudDpkaXNjb25uZWN0OiAnLCAnZmFpbGVkIScpDQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdDb3VsZCBub3QgZGlzY29ubmVjdCcpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpTXF0dENsaWVudDpkaXNjb25uZWN0OiAnLCAnc3VjY2VzcyEnKQ0KICAgICAgICAgICAgICAgIHJlc29sdmUoKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIC8vIF9fX19fX19fX3B1YmxpYyB2YXJpYW50OiBzdWJzY3JpYmUgdG9waWNfX19fX19fX19fX19fX19fX19fDQogICAgQ2lNcXR0Q2xpZW50LnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAodG9waWMsIHFvcykgew0KICAgICAgICB0aGlzLnN1YlRvcGljID0gdG9waWM7DQogICAgICAgIHRoaXMuc3ViUW9zID0gcW9zOw0KICAgICAgICByZXR1cm4gdGhpcy5zdWJzY3JpYmVfKCk7DQogICAgfTsNCiAgICAvLyBfX19fX19fX19wcml2YXRlIHZhcmlhbnQ6IHN1YnNjcmliZSB0b3BpY19fX19fX19fX19fX19fX19fXw0KICAgIENpTXF0dENsaWVudC5wcm90b3R5cGUuc3Vic2NyaWJlXyA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsNCiAgICAgICAgICAgIGlmICghX3RoaXMuY2xpZW50KSB7DQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpTXF0dENsaWVudDpzdWJzY3JpYmU6IGZhaWxlZCAtIG5vdCBjb25uZWN0ZWQhICcgKyB0aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnRvcGljKQ0KICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdzdWJzY3JpYmU6IE5vdCBDb25uZWN0ZWQnKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBfdGhpcy51bnN1YnNjcmliZSgpOw0KICAgICAgICAgICAgX3RoaXMuY2xpZW50LnN1YnNjcmliZShfdGhpcy5zdWJUb3BpYywgeyBxb3M6IF90aGlzLnN1YlFvcyB9LCBmdW5jdGlvbiAoZXJyKSB7DQogICAgICAgICAgICAgICAgaWYgKGVycikgew0KICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2lNcXR0Q2xpZW50OnN1YnNjcmliZTogZmFpbGVkISAnICsgdGhpcy5zdWJUb3BpYykNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ0NvdWxkIG5vdCBzdWJzY3JpYmUgdG9waWMgJyArIF90aGlzLnN1YlRvcGljKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnN1YnNjcmliZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnRvcGljID0gX3RoaXMuc3ViVG9waWM7DQogICAgICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24ucW9zID0gX3RoaXMuc3ViUW9zOw0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaU1xdHRDbGllbnQ6c3Vic2NyaWJlOiBzdWNjZXNzISAnICsgdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYykNCiAgICAgICAgICAgICAgICByZXNvbHZlKCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgfTsNCiAgICAvLyBfX19fX19fX191bnN1YnNjcmliZSB0b3BpY19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0KICAgIENpTXF0dENsaWVudC5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICB2YXIgc3Vic2NyaWJlZE9sZCA9IF90aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnN1YnNjcmliZWQ7DQogICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkID0gZmFsc2U7DQogICAgICAgICAgICBpZiAoIV90aGlzLmNsaWVudCkgew0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaU1xdHRDbGllbnQ6dW5zdWJzY3JpYmU6IGZhaWxlZCAtIG5vdCBjb25uZWN0ZWQhICcsIHRoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24udG9waWMpDQogICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ05vdCBDb25uZWN0ZWQnKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoc3Vic2NyaWJlZE9sZCkgew0KICAgICAgICAgICAgICAgIF90aGlzLmNsaWVudC51bnN1YnNjcmliZShfdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYywge30sIGZ1bmN0aW9uIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpTXF0dENsaWVudDp1bnN1YnNjcmliZTogZmFpbGVkISAnLCB0aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnRvcGljKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ0NvdWxkIG5vdCB1bnN1YnNjcmliZSB0b3BpYyAnICsgX3RoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24udG9waWMpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2lNcXR0Q2xpZW50OnVuc3Vic2NyaWJlOiBzdWNjZXNzISAnLCB0aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnRvcGljKQ0KICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH07DQogICAgLy8gX19fX19fX19fcHVibGlzaCBhIG1lc3NhZ2VfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLnB1Ymxpc2ggPSBmdW5jdGlvbiAodG9waWMsIHBheWxvYWQsIHJldGFpbiwgcW9zKSB7DQogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBpZiAoIV90aGlzLmNsaWVudCkNCiAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignTm90IENvbm5lY3RlZCcpKTsNCiAgICAgICAgICAgIF90aGlzLmNsaWVudC5wdWJsaXNoKHRvcGljLCBwYXlsb2FkLCB7IHFvczogcW9zLCByZXRhaW46IHJldGFpbiB9LCBmdW5jdGlvbiAoZXJyKSB7DQogICAgICAgICAgICAgICAgaWYgKGVycikNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ0NvdWxkIG5vdCBwdWJsaXNoIHRvcGljICcgKyB0b3BpYykpOw0KICAgICAgICAgICAgICAgIHJlc29sdmUoKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIC8vIF9fX19fX19fX3JldHVybiBtcXR0IGNvbm5lY3Rpb24gc3RhdGUgYXMgc3RyaW5nX19fX19fX19fX19fDQogICAgQ2lNcXR0Q2xpZW50LnByb3RvdHlwZS5zQ29ubk1xdHRTdGF0ZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgc3dpdGNoICh0aGlzLm1xdHRTdGF0ZS5pQ29ubk1xdHRTdGF0ZSkgew0KICAgICAgICAgICAgY2FzZSAtMTogcmV0dXJuICdub3QgY29ubmVjdGVkJzsNCiAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuICdkaXNjb25uZWN0ZWQnOw0KICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gJ2Nvbm5lY3RlZCc7DQogICAgICAgICAgICBjYXNlIDI6IHJldHVybiAnY29ubmVjdGluZyB0byAnICsgdGhpcy5jb25uZWN0VXJsKCk7DQogICAgICAgICAgICBjYXNlIDM6IHJldHVybiAnb2ZmbGluZSc7DQogICAgICAgICAgICBjYXNlIDc6IHJldHVybiAnbXF0dCBlcnJvcic7DQogICAgICAgICAgICBjYXNlIDg6IHJldHVybiAndGltZW91dCc7DQogICAgICAgICAgICBjYXNlIDk6IHJldHVybiAnZW5kIGNvbm5lY3RlZCc7DQogICAgICAgICAgICBkZWZhdWx0OiBicmVhazsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gJ3VuZGVmaW5lZCc7DQogICAgfTsNCiAgICAvLyBfX19fX19fX19jb25uZWN0IHRvIGEgYnJva2VyIGFuZCBzdWJzY3JpYmUgYSB0b3BpY19fX19fX19fXw0KICAgIENpTXF0dENsaWVudC5wcm90b3R5cGUuaG9zdFN1YnNjcmliZSA9IGZ1bmN0aW9uIChob3N0LCB0b3BpY1N1YnNjcmliZSkgew0KICAgICAgICB0aGlzLnByaXZhdGVNcXR0Q29ubmVjdGlvbi5ob3N0ID0gaG9zdDsNCiAgICAgICAgdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYyA9IHRvcGljU3Vic2NyaWJlOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgdGhpcy5jb25uZWN0XygpOw0KICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVfKCk7DQogICAgICAgIH0NCiAgICAgICAgY2F0Y2ggKGVycikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ2lNcXR0Q2xpZW50Lmhvc3RTdWJzY3JpYmU6IEVycm9yICcgKyBlcnIpOw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH07DQogICAgLy8gX19fX19fX19fbWV0aG9kIHRvIHJlZ2lzdGVyIGNvbnRyb2xsZXJfX19fX19fX19fX19fX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLnJlZ2lzdGVyQ29udHJvbGxlciA9IGZ1bmN0aW9uIChjb250cm9sbGVyKSB7DQogICAgICAgIHRoaXMuY29udHJvbGxlci5wdXNoKGNvbnRyb2xsZXIpOw0KICAgICAgICBjb250cm9sbGVyLnJlZ2lzdGVyQ2xpZW50KHRoaXMpOw0KICAgIH07DQogICAgLy8gX19fX19fX19fcmVjb25uZWN0IHRvIGJyb2tlciB3aXRoIGRlZmF1bHQgdmFsdWVzX19fX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLnJlY29ubmVjdEJyb2tlciA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHRoaXMuY29ubmVjdF8oKTsNCiAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlXygpOw0KICAgICAgICB9DQogICAgICAgIGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NpTXF0dENsaWVudC5yZWNvbm5lY3RCcm9rZXI6IEVycm9yICcgKyBlcnIpOw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH07DQogICAgLy8gX19fX19fX19fbm90aGluZyB0byBkby4uLl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCdDaU1xdHRDbGllbnQuaW5pdCcpOw0KICAgIH07DQogICAgcmV0dXJuIENpTXF0dENsaWVudDsNCn0oKSk7DQpleHBvcnQgeyBDaU1xdHRDbGllbnQgfTsNCg=="},{"version":3,"file":"G:\\work3\\vue\\haus2\\src\\services\\CiMqttClient.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus2\\src\\services\\CiMqttClient.ts"],"names":[],"mappings":"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","sourcesContent":["// ______CiMqttClient.ts_________________________2021-12-26_____\r\nimport { CiBaseController } from '@/controller/CiBaseController'\r\nimport mqtt, { QoS } from 'mqtt'\r\nimport { reactive, readonly } from 'vue'\r\n\r\n// *************************************************************\r\n// interfaces\r\n// *************************************************************\r\n\r\n// -----------message properties--------------------------------\r\nexport interface Message {\r\n  topic: string,\r\n  payload: string,\r\n  retain: boolean,\r\n  qos: QoS\r\n}\r\n\r\n// -----------state of the MQTT connection----------------------\r\nexport interface MqttState {\r\n  connectOnStart: boolean;\r\n  connected: boolean;\r\n  iConnMqttState: number;\r\n  message: Message;\r\n}\r\n\r\n// -----------properties for the MQTT connection----------------\r\nexport interface MqttConnection {\r\n  host: string;\r\n  port: number;\r\n  endpoint: string;\r\n  clean: boolean;\r\n  connectTimeout: number;\r\n  reconnectPeriod: number;\r\n  clientId: string;\r\n  username: string;\r\n  password: string;\r\n}\r\n\r\n// -----------info about the subscribed messages----------------\r\nexport interface MqttSubscription {\r\n  topic: string;\r\n  qos: QoS;\r\n  subscribed: boolean;\r\n}\r\n\r\n// *************************************************************\r\n// class CiMqttClient\r\n// *************************************************************\r\n\r\nexport class CiMqttClient {\r\n  // ---------basic properties----------------------------------\r\n  public client: mqtt.Client | null = null;\r\n  public controller: Array<CiBaseController> = [];\r\n\r\n  private subTopic = '#';\r\n  private subQos: QoS = 0;\r\n\r\n  // ---------some more properties (interfaces)-----------------\r\n  // To prevent values from being changed by mistake,\r\n  // there is always a private and a public variant.\r\n  private privateMqttState: MqttState = reactive<MqttState>({\r\n    connectOnStart: false,\r\n    connected: false,\r\n    iConnMqttState: -1,\r\n    message: { topic: '', payload: '', retain: false, qos: 0 }\r\n  })\r\n\r\n  public mqttState = readonly(this.privateMqttState)\r\n\r\n  private privateMqttConnection: MqttConnection = reactive<MqttConnection>({\r\n    host: '192.168.0.7', // '10.1.1.1',\r\n    port: 1884,\r\n    endpoint: '',\r\n    clean: true,\r\n    connectTimeout: 4000,\r\n    reconnectPeriod: 4000,\r\n    clientId: '',\r\n    username: '',\r\n    password: ''\r\n  })\r\n\r\n  public mqttConnection = readonly(this.privateMqttConnection)\r\n\r\n  private privateMqttSubscription: MqttSubscription = reactive<MqttSubscription>({\r\n    topic: '#',\r\n    qos: 0,\r\n    subscribed: false\r\n  })\r\n\r\n  public mqttSubscription = readonly(this.privateMqttSubscription)\r\n\r\n  // =========methods===========================================\r\n  // _________constructor_______________________________________\r\n  constructor (connectOnStart: boolean) {\r\n    this.privateMqttState.connectOnStart = connectOnStart\r\n    console.log('MqttClient-Constructor: privateMqttState.connectOnStart = ', this.privateMqttState.connectOnStart)\r\n    if (this.privateMqttState.connectOnStart) {\r\n      console.log('MqttClient-Constructor: connecting to ' + this.connectUrl())\r\n      this.connect_()\r\n      this.subTopic = this.privateMqttSubscription.topic\r\n      this.subQos = this.privateMqttSubscription.qos\r\n      console.log('MqttClient-Constructor: subscribe ' + this.privateMqttSubscription.topic)\r\n      this.subscribe_()\r\n      console.log('MqttClient-Constructor: finished')\r\n    }\r\n  }\r\n\r\n  // _________connect url like 10.1.1.1:1884____________________\r\n  public connectUrl (): string {\r\n    return `ws://${this.mqttConnection.host}:${this.mqttConnection.port}${this.mqttConnection.endpoint}`\r\n  }\r\n\r\n  // _________public variant: connect to server (broker)________\r\n  public connect (host: string, port: number, endpoint: string): Promise<void> {\r\n    this.privateMqttConnection.host = host\r\n    this.privateMqttConnection.port = port\r\n    this.privateMqttConnection.endpoint = endpoint\r\n    return this.connect_()\r\n  }\r\n\r\n  // _________private variant: connect to server (broker)_______\r\n  private connect_ (): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (this.client) this.disconnect()\r\n      this.privateMqttState.iConnMqttState = 2\r\n      const options_ = {\r\n        clean: this.mqttConnection.clean,\r\n        connectTimeout: this.mqttConnection.connectTimeout,\r\n        reconnectPeriod: this.mqttConnection.reconnectPeriod,\r\n        clientId: this.mqttConnection.clientId,\r\n        username: this.mqttConnection.username,\r\n        password: this.mqttConnection.password\r\n      }\r\n      console.log('MqttCient.ts-connect: url=' + this.connectUrl())\r\n      const client = mqtt.connect(this.connectUrl(), options_)\r\n      this.client = client\r\n      this.client.on('connect', () => {\r\n        this.privateMqttState.connected = true\r\n        this.privateMqttState.iConnMqttState = 1\r\n        client.on('error', (err) => {\r\n          console.error('MQTT Error', err)\r\n          this.privateMqttState.iConnMqttState = 7\r\n        })\r\n        client.on('connecting', () => {\r\n          console.error('MQTT Connecting')\r\n          this.privateMqttState.iConnMqttState = 2\r\n        })\r\n        client.on('offline', (value: any) => {\r\n          this.privateMqttState.connected = false\r\n          this.privateMqttSubscription.subscribed = false\r\n          console.error('MQTT Offline', value)\r\n          this.privateMqttState.iConnMqttState = 3\r\n        })\r\n        client.on('disconnect', (value: any) => {\r\n          console.error('MQTT Disconnect', value)\r\n          this.privateMqttState.iConnMqttState = 0\r\n        })\r\n        client.on('end', (value: any) => {\r\n          this.privateMqttState.connected = false\r\n          this.privateMqttSubscription.subscribed = false\r\n          console.error('MqttClient.ts-end: value=', value)\r\n          this.privateMqttState.iConnMqttState = 9\r\n        })\r\n        client.on('message', (topic: string, payload: any, props1: any) => {\r\n          let retain1 = false\r\n          try {\r\n            retain1 = props1.retain\r\n          } catch (error) { console.error(error) }\r\n          let qos1 = 0 as QoS\r\n          try {\r\n            qos1 = props1.qos\r\n          } catch (error) { console.error(error) }\r\n          this.controller.forEach(controller => controller.onMessage({\r\n            topic: topic,\r\n            payload: payload.toString(),\r\n            retain: retain1,\r\n            qos: qos1\r\n          }))\r\n        })\r\n        resolve()\r\n      })\r\n      client.on('error', () => {\r\n        console.error('Error on connecting...')\r\n        this.privateMqttState.iConnMqttState = 8\r\n        reject(Error('Error'))\r\n      })\r\n    })\r\n  }\r\n\r\n  // _________disconnect from broker____________________________\r\n  public disconnect (): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.client) return reject(new Error('Not Connected'))\r\n      this.privateMqttState.iConnMqttState = 9\r\n      this.client.end(true, {}, (err) => {\r\n        if (err) {\r\n          // console.log('CiMqttClient:disconnect: ', 'failed!')\r\n          return reject(new Error('Could not disconnect'))\r\n        }\r\n        // console.log('CiMqttClient:disconnect: ', 'success!')\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  // _________public variant: subscribe topic___________________\r\n  public subscribe (topic: string, qos: QoS): Promise<void> {\r\n    this.subTopic = topic\r\n    this.subQos = qos\r\n    return this.subscribe_()\r\n  }\r\n\r\n  // _________private variant: subscribe topic__________________\r\n  private subscribe_ (): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.client) {\r\n        // console.log('CiMqttClient:subscribe: failed - not connected! ' + this.privateMqttSubscription.topic)\r\n        return reject(new Error('subscribe: Not Connected'))\r\n      }\r\n      this.unsubscribe()\r\n      this.client.subscribe(this.subTopic, { qos: this.subQos }, (err) => {\r\n        if (err) {\r\n          // console.log('CiMqttClient:subscribe: failed! ' + this.subTopic)\r\n          return reject(new Error('Could not subscribe topic ' + this.subTopic))\r\n        }\r\n        this.privateMqttSubscription.subscribed = true\r\n        this.privateMqttSubscription.topic = this.subTopic\r\n        this.privateMqttSubscription.qos = this.subQos\r\n        // console.log('CiMqttClient:subscribe: success! ' + this.privateMqttSubscription.topic)\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  // _________unsubscribe topic_________________________________\r\n  public unsubscribe (): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      const subscribedOld = this.privateMqttSubscription.subscribed\r\n      this.privateMqttSubscription.subscribed = false\r\n      if (!this.client) {\r\n        // console.log('CiMqttClient:unsubscribe: failed - not connected! ', this.privateMqttSubscription.topic)\r\n        return reject(new Error('Not Connected'))\r\n      }\r\n      if (subscribedOld) {\r\n        this.client.unsubscribe(this.privateMqttSubscription.topic, {}, (err) => {\r\n          if (err) {\r\n            // console.log('CiMqttClient:unsubscribe: failed! ', this.privateMqttSubscription.topic)\r\n            return reject(new Error('Could not unsubscribe topic ' + this.privateMqttSubscription.topic))\r\n          }\r\n          // console.log('CiMqttClient:unsubscribe: success! ', this.privateMqttSubscription.topic)\r\n          resolve()\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  // _________publish a message_________________________________\r\n  public publish (topic: string, payload: string, retain: boolean, qos: QoS): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.client) return reject(new Error('Not Connected'))\r\n      this.client.publish(topic, payload, { qos: qos, retain: retain }, (err) => {\r\n        if (err) return reject(new Error('Could not publish topic ' + topic))\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  // _________return mqtt connection state as string____________\r\n  public sConnMqttState (): string {\r\n    switch (this.mqttState.iConnMqttState) {\r\n      case -1: return 'not connected'\r\n      case 0: return 'disconnected'\r\n      case 1: return 'connected'\r\n      case 2: return 'connecting to ' + this.connectUrl()\r\n      case 3: return 'offline'\r\n      case 7: return 'mqtt error'\r\n      case 8: return 'timeout'\r\n      case 9: return 'end connected'\r\n      default: break\r\n    }\r\n    return 'undefined'\r\n  }\r\n\r\n  // _________connect to a broker and subscribe a topic_________\r\n  public hostSubscribe (host: string, topicSubscribe: string): boolean {\r\n    this.privateMqttConnection.host = host\r\n    this.privateMqttSubscription.topic = topicSubscribe\r\n    try {\r\n      this.connect_()\r\n      this.subscribe_()\r\n    } catch (err) {\r\n      console.error('CiMqttClient.hostSubscribe: Error ' + err)\r\n      return false\r\n    }\r\n    return true\r\n  }\r\n\r\n  // _________method to register controller_____________________\r\n  public registerController (controller: CiBaseController): void {\r\n    this.controller.push(controller)\r\n    controller.registerClient(this)\r\n  }\r\n\r\n  // _________reconnect to broker with default values___________\r\n  public reconnectBroker (): boolean {\r\n    try {\r\n      this.connect_()\r\n      this.subscribe_()\r\n    } catch (err) {\r\n      console.error('CiMqttClient.reconnectBroker: Error ' + err)\r\n      return false\r\n    }\r\n    return true\r\n  }\r\n\r\n  // _________nothing to do...__________________________________\r\n  public init (): void {\r\n    console.log('CiMqttClient.init')\r\n  }\r\n}\r\n"]}]}