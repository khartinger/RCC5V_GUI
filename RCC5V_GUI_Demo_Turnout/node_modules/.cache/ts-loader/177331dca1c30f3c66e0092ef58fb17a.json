{"remainingRequest":"G:\\work3\\vue\\haus2\\node_modules\\ts-loader\\index.js??ref--13-1!G:\\work3\\vue\\haus2\\src\\controller\\CiButtonController.ts","dependencies":[{"path":"G:\\work3\\vue\\haus2\\src\\controller\\CiButtonController.ts","mtime":1641040872850},{"path":"G:\\work3\\vue\\haus2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus2\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSAidHNsaWIiOw0KLy8gX19fX19fQ2lCdXR0b25Db250cm9sbGVyLnRzX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0KaW1wb3J0IHsgcmVhY3RpdmUgfSBmcm9tICd2dWUnOw0KaW1wb3J0IHsgQ2lCYXNlQ29udHJvbGxlciB9IGZyb20gJy4vQ2lCYXNlQ29udHJvbGxlcic7DQp2YXIgQ2lCdXR0b25Db250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgew0KICAgIF9fZXh0ZW5kcyhDaUJ1dHRvbkNvbnRyb2xsZXIsIF9zdXBlcik7DQogICAgZnVuY3Rpb24gQ2lCdXR0b25Db250cm9sbGVyKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsNCiAgICAgICAgX3RoaXMuYnV0dG9ucyA9IHJlYWN0aXZlKFsNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ2JlMWFyMScsDQogICAgICAgICAgICAgICAgbmFtZTogJ0xhbXBlMycsDQogICAgICAgICAgICAgICAgaUJ1dHRvblN0YXRlOiA5OSwNCiAgICAgICAgICAgICAgICBiYXR0ZXJ5OiAnLScsDQogICAgICAgICAgICAgICAgc2hhcGU6ICdyZWN0JywNCiAgICAgICAgICAgICAgICBjb2xvcjogJyM3Nzc3MjInLA0KICAgICAgICAgICAgICAgIHN1YlRvcGljOiAnZTEvYXIvdGFzdGVyLzMvcmV0L3ZvbHRhZ2UnLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnZTEvYXIvbGljaHQvMy9zZXQvbGljaHQnLA0KICAgICAgICAgICAgICAgIHB1YlBheWxvYWQ6ICctMScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWQ6ICdibzJzbDEnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdMYW1wZTEnLA0KICAgICAgICAgICAgICAgIGlCdXR0b25TdGF0ZTogOTksDQogICAgICAgICAgICAgICAgYmF0dGVyeTogJy0nLA0KICAgICAgICAgICAgICAgIHNoYXBlOiAncmVjdCcsDQogICAgICAgICAgICAgICAgLy8gY29sb3I6ICcjNzc3NzIyJywNCiAgICAgICAgICAgICAgICBzdWJUb3BpYzogJ28yL3NsL3Rhc3Rlci8xL3JldC92b2x0YWdlJywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzogJ28yL3NsL2xpY2h0LzEvc2V0L2xpY2h0JywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAnLTEnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlkOiAnYmUxdm9ybzEnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdST0xMTyBeJywNCiAgICAgICAgICAgICAgICBpQnV0dG9uU3RhdGU6IC05LA0KICAgICAgICAgICAgICAgIGJhdHRlcnk6ICctJywNCiAgICAgICAgICAgICAgICBzaGFwZTogJ3VwJywNCiAgICAgICAgICAgICAgICB0ZXh0MzogJ0FVRicsDQogICAgICAgICAgICAgICAgc3ViVG9waWM6ICdlMS92by9yb2xsby9yZXQvbW90b3InLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnZTEvdm8vcm9sbG8vc2V0L21vdG9yJywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAnMScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWQ6ICdiZTF2b3JvMicsDQogICAgICAgICAgICAgICAgbmFtZTogJ1JPTExPIFYnLA0KICAgICAgICAgICAgICAgIGlCdXR0b25TdGF0ZTogLTksDQogICAgICAgICAgICAgICAgYmF0dGVyeTogJy0nLA0KICAgICAgICAgICAgICAgIHNoYXBlOiAnZG93bicsDQogICAgICAgICAgICAgICAgdGV4dDM6ICdBQicsDQogICAgICAgICAgICAgICAgc3ViVG9waWM6ICdlMS92by9yb2xsby9yZXQvbW90b3InLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnZTEvdm8vcm9sbG8vc2V0L21vdG9yJywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAnLTEnDQogICAgICAgICAgICB9DQogICAgICAgIF0pOw0KICAgICAgICByZXR1cm4gX3RoaXM7DQogICAgfQ0KICAgIENpQnV0dG9uQ29udHJvbGxlci5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHsNCiAgICAgICAgdGhpcy5idXR0b25zLmZvckVhY2goZnVuY3Rpb24gKGJ1dHRvbikgew0KICAgICAgICAgICAgdmFyIGFTdWJUb3BpYyA9IGJ1dHRvbi5zdWJUb3BpYy5zcGxpdCgnICcpOw0KICAgICAgICAgICAgaWYgKGFTdWJUb3BpYy5pbmNsdWRlcyhtZXNzYWdlLnRvcGljKSkgew0KICAgICAgICAgICAgICAgIC8vIC0tLWJ1dHRvbiBmb3VuZCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2lCdXR0b25Db250cm9sbGVyLm9uTWVzc2FnZSBwYXlsb2FkPScsIG1lc3NhZ2UucGF5bG9hZCkNCiAgICAgICAgICAgICAgICBpZiAoYnV0dG9uLmlkLnN1YnN0cmluZygwLCA3KSA9PT0gJ2JlMXZvcm8nKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhUGF5bG9hZCA9IEpTT04ucGFyc2UobWVzc2FnZS5wYXlsb2FkKTsNCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmlCdXR0b25TdGF0ZSA9IDEwICsgYVBheWxvYWQubW90b3I7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS50b3BpYy5pbmNsdWRlcygndm9sdGFnZScpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uYmF0dGVyeSA9ICIiICsgbWVzc2FnZS5wYXlsb2FkICsgJyUnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIENpQnV0dG9uQ29udHJvbGxlci5wcm90b3R5cGUucHVibGlzaENpID0gZnVuY3Rpb24gKHRvcGljLCBwYXlsb2FkKSB7DQogICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaUJ1dHRvbkNvbnRyb2xsZXI6cHVibGlzaENpOicsICctdCAnICsgdG9waWMgKyAnIC1tICcgKyBwYXlsb2FkKQ0KICAgICAgICB0aGlzLnB1Ymxpc2godG9waWMsIHBheWxvYWQsIGZhbHNlLCAwKTsNCiAgICB9Ow0KICAgIHJldHVybiBDaUJ1dHRvbkNvbnRyb2xsZXI7DQp9KENpQmFzZUNvbnRyb2xsZXIpKTsNCmV4cG9ydCB7IENpQnV0dG9uQ29udHJvbGxlciB9Ow0KZXhwb3J0IHZhciBjaUJ1dHRvbkNvbnRyb2xsZXIgPSBuZXcgQ2lCdXR0b25Db250cm9sbGVyKCk7DQo="},{"version":3,"file":"G:\\work3\\vue\\haus2\\src\\controller\\CiButtonController.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus2\\src\\controller\\CiButtonController.ts"],"names":[],"mappings":";AAAA,gEAAgE;AAChE,OAAO,EAAE,QAAQ,EAAE,MAAM,KAAK,CAAA;AAE9B,OAAO,EAAE,gBAAgB,EAAS,MAAM,oBAAoB,CAAA;AAW5D;IAAwC,sCAAgB;IAAxD;QAAA,qEAyEC;QAxEQ,aAAO,GAAkB,QAAQ,CACtC;YACE;gBACE,EAAE,EAAE,QAAQ;gBACZ,IAAI,EAAE,QAAQ;gBACd,YAAY,EAAE,EAAE;gBAChB,OAAO,EAAE,GAAG;gBACZ,KAAK,EAAE,MAAM;gBACb,KAAK,EAAE,SAAS;gBAChB,QAAQ,EAAE,4BAA4B;gBACtC,QAAQ,EAAE,yBAAyB;gBACnC,UAAU,EAAE,IAAI;aACjB;YACD;gBACE,EAAE,EAAE,QAAQ;gBACZ,IAAI,EAAE,QAAQ;gBACd,YAAY,EAAE,EAAE;gBAChB,OAAO,EAAE,GAAG;gBACZ,KAAK,EAAE,MAAM;gBACb,oBAAoB;gBACpB,QAAQ,EAAE,4BAA4B;gBACtC,QAAQ,EAAE,yBAAyB;gBACnC,UAAU,EAAE,IAAI;aACjB;YACD;gBACE,EAAE,EAAE,UAAU;gBACd,IAAI,EAAE,SAAS;gBACf,YAAY,EAAE,CAAC,CAAC;gBAChB,OAAO,EAAE,GAAG;gBACZ,KAAK,EAAE,IAAI;gBACX,KAAK,EAAE,KAAK;gBACZ,QAAQ,EAAE,uBAAuB;gBACjC,QAAQ,EAAE,uBAAuB;gBACjC,UAAU,EAAE,GAAG;aAChB;YACD;gBACE,EAAE,EAAE,UAAU;gBACd,IAAI,EAAE,SAAS;gBACf,YAAY,EAAE,CAAC,CAAC;gBAChB,OAAO,EAAE,GAAG;gBACZ,KAAK,EAAE,MAAM;gBACb,KAAK,EAAE,IAAI;gBACX,QAAQ,EAAE,uBAAuB;gBACjC,QAAQ,EAAE,uBAAuB;gBACjC,UAAU,EAAE,IAAI;aACjB;SACF,CACF,CAAC;;IAyBJ,CAAC;IAvBQ,sCAAS,GAAhB,UAAkB,OAAgB;QAChC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,MAAM;YACzB,IAAM,SAAS,GAAG,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;YAC5C,IAAI,SAAS,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBACrC,oDAAoD;gBACpD,wEAAwE;gBACxE,IAAI,MAAM,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,SAAS,EAAE;oBAC3C,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;oBAC5C,MAAM,CAAC,YAAY,GAAG,EAAE,GAAG,QAAQ,CAAC,KAAK,CAAA;iBAC1C;qBACI;oBACH,IAAI,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;wBACrC,MAAM,CAAC,OAAO,GAAG,KAAG,OAAO,CAAC,OAAS,GAAG,GAAG,CAAA;qBAC5C;iBACF;aACF;QACH,CAAC,CAAC,CAAA;IACJ,CAAC;IAEM,sCAAS,GAAhB,UAAkB,KAAa,EAAE,OAAe;QAC9C,iFAAiF;QACjF,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAA;IACxC,CAAC;IACH,yBAAC;AAAD,CAAC,AAzED,CAAwC,gBAAgB,GAyEvD;;AAED,MAAM,CAAC,IAAM,kBAAkB,GAAG,IAAI,kBAAkB,EAAE,CAAA","sourcesContent":["// ______CiButtonController.ts__________________________________\r\nimport { reactive } from 'vue'\r\nimport { Message } from '@/services/CiMqttClient'\r\nimport { CiBaseController, IBase } from './CiBaseController'\r\n\r\nexport interface Button extends IBase {\r\n  iButtonState: number;\r\n  battery: string;\r\n  shape?: string;\r\n  color?: string;\r\n  text3?: string;\r\n  text5?: string;\r\n}\r\n\r\nexport class CiButtonController extends CiBaseController {\r\n  public buttons: Array<Button> = reactive(\r\n    [\r\n      {\r\n        id: 'be1ar1',\r\n        name: 'Lampe3',\r\n        iButtonState: 99,\r\n        battery: '-',\r\n        shape: 'rect',\r\n        color: '#777722',\r\n        subTopic: 'e1/ar/taster/3/ret/voltage',\r\n        pubTopic: 'e1/ar/licht/3/set/licht',\r\n        pubPayload: '-1'\r\n      },\r\n      {\r\n        id: 'bo2sl1',\r\n        name: 'Lampe1',\r\n        iButtonState: 99,\r\n        battery: '-',\r\n        shape: 'rect',\r\n        // color: '#777722',\r\n        subTopic: 'o2/sl/taster/1/ret/voltage',\r\n        pubTopic: 'o2/sl/licht/1/set/licht',\r\n        pubPayload: '-1'\r\n      },\r\n      { // Erdgeschoss: Bereich 1, Rollo auf\r\n        id: 'be1voro1',\r\n        name: 'ROLLO ^',\r\n        iButtonState: -9,\r\n        battery: '-',\r\n        shape: 'up',\r\n        text3: 'AUF',\r\n        subTopic: 'e1/vo/rollo/ret/motor',\r\n        pubTopic: 'e1/vo/rollo/set/motor',\r\n        pubPayload: '1'\r\n      },\r\n      { // Erdgeschoss: Bereich 1, Rollo ab\r\n        id: 'be1voro2',\r\n        name: 'ROLLO V',\r\n        iButtonState: -9,\r\n        battery: '-',\r\n        shape: 'down',\r\n        text3: 'AB',\r\n        subTopic: 'e1/vo/rollo/ret/motor',\r\n        pubTopic: 'e1/vo/rollo/set/motor',\r\n        pubPayload: '-1'\r\n      }\r\n    ]\r\n  );\r\n\r\n  public onMessage (message: Message): void {\r\n    this.buttons.forEach(button => {\r\n      const aSubTopic = button.subTopic.split(' ')\r\n      if (aSubTopic.includes(message.topic)) {\r\n        // ---button found ---------------------------------\r\n        // console.log('CiButtonController.onMessage payload=', message.payload)\r\n        if (button.id.substring(0, 7) === 'be1voro') {\r\n          const aPayload = JSON.parse(message.payload)\r\n          button.iButtonState = 10 + aPayload.motor\r\n        }\r\n        else {\r\n          if (message.topic.includes('voltage')) {\r\n            button.battery = `${message.payload}` + '%'\r\n          }\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  public publishCi (topic: string, payload: string): void {\r\n    // console.log('CiButtonController:publishCi:', '-t ' + topic + ' -m ' + payload)\r\n    this.publish(topic, payload, false, 0)\r\n  }\r\n}\r\n\r\nexport const ciButtonController = new CiButtonController()\r\n"]}]}