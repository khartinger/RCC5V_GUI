{"remainingRequest":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js??ref--13-1!G:\\work3\\vue\\haus3\\src\\controller\\CiSocket1Controller.ts","dependencies":[{"path":"G:\\work3\\vue\\haus3\\src\\controller\\CiSocket1Controller.ts","mtime":1675010039599},{"path":"G:\\work3\\vue\\haus3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSAidHNsaWIiOw0KLy8gX19fX19fQ2lTb2NrZXQxQ29udHJvbGxlci50c19fX19fX19fX19fX19fX19fX2toYXJ0aW5nZXJfX19fXw0KLy8gMjAyMi0wOS0xNDogbmV3DQovLyAyMDIzLTAxLTI5OiBjaGFuZ2UgYXQgQ2lCYXNlIChhZGQgR2VvLnRzKQ0KaW1wb3J0IHsgcmVhY3RpdmUgfSBmcm9tICd2dWUnOw0KaW1wb3J0IHsgQ2lCYXNlQ29udHJvbGxlciB9IGZyb20gJy4vQ2lCYXNlQ29udHJvbGxlcic7DQp2YXIgQ2lTb2NrZXQxQ29udHJvbGxlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsNCiAgICBfX2V4dGVuZHMoQ2lTb2NrZXQxQ29udHJvbGxlciwgX3N1cGVyKTsNCiAgICBmdW5jdGlvbiBDaVNvY2tldDFDb250cm9sbGVyKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsNCiAgICAgICAgX3RoaXMuc29ja2V0czEgPSByZWFjdGl2ZShbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWQ6ICdzb2NrZXQxJywNCiAgICAgICAgICAgICAgICBuYW1lOiAnU29ja2V0MV8xJywNCiAgICAgICAgICAgICAgICBpU29ja2V0MVN0YXRlOiAtOTksDQogICAgICAgICAgICAgICAgdHlwZTogJ2UxNjAzJywNCiAgICAgICAgICAgICAgICB0ZXh0Rm9vdGVyOiAnLS1Gb290ZXIxLS0nLA0KICAgICAgICAgICAgICAgIHN1YlRvcGljOiAnY2kvc29ja2V0LzEnLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnY2kvc29ja2V0LzEvc2V0JywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAneyJzdGF0ZSI6ICJUT0dHTEUifScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWQ6ICdzb2NrZXQyJywNCiAgICAgICAgICAgICAgICBuYW1lOiAnU29ja2V0MV8yJywNCiAgICAgICAgICAgICAgICBpU29ja2V0MVN0YXRlOiAtOTksDQogICAgICAgICAgICAgICAgdHlwZTogJ2UxNjAzJywNCiAgICAgICAgICAgICAgICB0ZXh0Q2VudGVyOiAnQ0VOVEVSJywNCiAgICAgICAgICAgICAgICB0ZXh0Rm9vdGVyOiAnPT1Gb290ZXIyPT0nLA0KICAgICAgICAgICAgICAgIHN1YlRvcGljOiAnY2kvc29ja2V0LzInLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnY2kvc29ja2V0LzIvc2V0JywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAneyJzdGF0ZSI6ICJUT0dHTEUifScNCiAgICAgICAgICAgIH0NCiAgICAgICAgXSk7DQogICAgICAgIHJldHVybiBfdGhpczsNCiAgICB9DQogICAgQ2lTb2NrZXQxQ29udHJvbGxlci5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHsNCiAgICAgICAgdGhpcy5zb2NrZXRzMS5mb3JFYWNoKGZ1bmN0aW9uIChzb2NrZXQxKSB7DQogICAgICAgICAgICB2YXIgYVN1YlRvcGljID0gc29ja2V0MS5zdWJUb3BpYy5zcGxpdCgnICcpOw0KICAgICAgICAgICAgaWYgKGFTdWJUb3BpYy5pbmNsdWRlcyhtZXNzYWdlLnRvcGljKSkgew0KICAgICAgICAgICAgICAgIC8vIC0tLXNvY2tldCBmb3VuZCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpU29ja2V0MUNvbnRyb2xsZXIub25NZXNzYWdlIHBheWxvYWQ9JywgbWVzc2FnZS5wYXlsb2FkKQ0KICAgICAgICAgICAgICAgIGlmIChzb2NrZXQxLnR5cGUgPT09ICdlMTYwMycpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFQYXlsb2FkID0gSlNPTi5wYXJzZShtZXNzYWdlLnBheWxvYWQpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoKGFQYXlsb2FkLnN0YXRlID09PSAnT04nKSB8fCAoYVBheWxvYWQuc3RhdGUgPT09ICdvbicpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgc29ja2V0MS5pU29ja2V0MVN0YXRlID0gLTE7DQogICAgICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChhUGF5bG9hZC5zdGF0ZSA9PT0gJ09GRicpIHx8IChhUGF5bG9hZC5zdGF0ZSA9PT0gJ29mZicpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldDEuaVNvY2tldDFTdGF0ZSA9IC0yOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ja2V0MS5pU29ja2V0MVN0YXRlID0gLTk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gLS0tZW5kIHNvY2tldCBmb3VuZC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsNCiAgICBDaVNvY2tldDFDb250cm9sbGVyLnByb3RvdHlwZS5wdWJsaXNoQ2kgPSBmdW5jdGlvbiAodG9waWMsIHBheWxvYWQpIHsNCiAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpU29ja2V0MUNvbnRyb2xsZXI6cHVibGlzaENpOicsICctdCAnICsgdG9waWMgKyAnIC1tICcgKyBwYXlsb2FkKQ0KICAgICAgICB0aGlzLnB1Ymxpc2godG9waWMsIHBheWxvYWQsIGZhbHNlLCAwKS5jYXRjaChmdW5jdGlvbiAoZSkgeyBjb25zb2xlLmVycm9yKCdDaVNvY2tldENvbnRyb2xsZXI6IEVSUk9SOicsIGUpOyB9KTsNCiAgICB9Ow0KICAgIHJldHVybiBDaVNvY2tldDFDb250cm9sbGVyOw0KfShDaUJhc2VDb250cm9sbGVyKSk7DQpleHBvcnQgeyBDaVNvY2tldDFDb250cm9sbGVyIH07DQpleHBvcnQgdmFyIGNpU29ja2V0MUNvbnRyb2xsZXIgPSBuZXcgQ2lTb2NrZXQxQ29udHJvbGxlcigpOw0K"},{"version":3,"file":"G:\\work3\\vue\\haus3\\src\\controller\\CiSocket1Controller.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus3\\src\\controller\\CiSocket1Controller.ts"],"names":[],"mappings":";AAAA,gEAAgE;AAChE,kBAAkB;AAClB,4CAA4C;AAC5C,OAAO,EAAE,QAAQ,EAAE,MAAM,KAAK,CAAA;AAE9B,OAAO,EAAE,gBAAgB,EAAS,MAAM,oBAAoB,CAAA;AAU5D;IAAyC,uCAAgB;IAAzD;QAAA,qEAkDC;QAjDQ,cAAQ,GAAmB,QAAQ,CACxC;YACE;gBACE,EAAE,EAAE,SAAS;gBACb,IAAI,EAAE,WAAW;gBACjB,aAAa,EAAE,CAAC,EAAE;gBAClB,IAAI,EAAE,OAAO;gBACb,UAAU,EAAE,aAAa;gBACzB,QAAQ,EAAE,aAAa;gBACvB,QAAQ,EAAE,iBAAiB;gBAC3B,UAAU,EAAE,qBAAqB;aAClC;YACD;gBACE,EAAE,EAAE,SAAS;gBACb,IAAI,EAAE,WAAW;gBACjB,aAAa,EAAE,CAAC,EAAE;gBAClB,IAAI,EAAE,OAAO;gBACb,UAAU,EAAE,QAAQ;gBACpB,UAAU,EAAE,aAAa;gBACzB,QAAQ,EAAE,aAAa;gBACvB,QAAQ,EAAE,iBAAiB;gBAC3B,UAAU,EAAE,qBAAqB;aAClC;SACF,CACF,CAAC;;IAyBJ,CAAC;IAvBQ,uCAAS,GAAhB,UAAkB,OAAgB;QAChC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,OAAO;YAC3B,IAAM,SAAS,GAAG,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;YAC7C,IAAI,SAAS,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBACrC,wDAAwD;gBACxD,yEAAyE;gBACzE,IAAI,OAAO,CAAC,IAAI,KAAK,OAAO,EAAE;oBAC5B,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;oBAC5C,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,IAAI,CAAC;wBAAE,OAAO,CAAC,aAAa,GAAG,CAAC,CAAC,CAAA;yBACjF;wBACH,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,KAAK,CAAC;4BAAE,OAAO,CAAC,aAAa,GAAG,CAAC,CAAC,CAAA;6BACnF;4BAAE,OAAO,CAAC,aAAa,GAAG,CAAC,CAAC,CAAA;yBAAE;qBACpC;iBACF;gBACD,wDAAwD;aACzD;QACH,CAAC,CAAC,CAAA;IACJ,CAAC;IAEM,uCAAS,GAAhB,UAAkB,KAAa,EAAE,OAAe;QAC9C,kFAAkF;QAClF,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,CAAC,IAAO,OAAO,CAAC,KAAK,CAAC,4BAA4B,EAAE,CAAC,CAAC,CAAA,CAAC,CAAC,CAAC,CAAA;IACzG,CAAC;IACH,0BAAC;AAAD,CAAC,AAlDD,CAAyC,gBAAgB,GAkDxD;;AAED,MAAM,CAAC,IAAM,mBAAmB,GAAG,IAAI,mBAAmB,EAAE,CAAA","sourcesContent":["// ______CiSocket1Controller.ts__________________khartinger_____\r\n// 2022-09-14: new\r\n// 2023-01-29: change at CiBase (add Geo.ts)\r\nimport { reactive } from 'vue'\r\nimport { Message } from '@/services/CiMqttClient'\r\nimport { CiBaseController, IBase } from './CiBaseController'\r\n\r\nexport interface Socket1 extends IBase {\r\n  iSocket1State: number;\r\n  type: string;\r\n  battery?: string;\r\n  textCenter?: string;\r\n  textFooter?: string;\r\n}\r\n\r\nexport class CiSocket1Controller extends CiBaseController {\r\n  public sockets1: Array<Socket1> = reactive(\r\n    [\r\n      {\r\n        id: 'socket1',\r\n        name: 'Socket1_1',\r\n        iSocket1State: -99,\r\n        type: 'e1603', // e1603=IKEA\r\n        textFooter: '--Footer1--',\r\n        subTopic: 'ci/socket/1',\r\n        pubTopic: 'ci/socket/1/set',\r\n        pubPayload: '{\"state\": \"TOGGLE\"}'\r\n      },\r\n      {\r\n        id: 'socket2',\r\n        name: 'Socket1_2',\r\n        iSocket1State: -99,\r\n        type: 'e1603', // e1603=IKEA\r\n        textCenter: 'CENTER',\r\n        textFooter: '==Footer2==',\r\n        subTopic: 'ci/socket/2',\r\n        pubTopic: 'ci/socket/2/set',\r\n        pubPayload: '{\"state\": \"TOGGLE\"}'\r\n      }\r\n    ]\r\n  );\r\n\r\n  public onMessage (message: Message): void {\r\n    this.sockets1.forEach(socket1 => {\r\n      const aSubTopic = socket1.subTopic.split(' ')\r\n      if (aSubTopic.includes(message.topic)) {\r\n        // ---socket found -------------------------------------\r\n        // console.log('CiSocket1Controller.onMessage payload=', message.payload)\r\n        if (socket1.type === 'e1603') {\r\n          const aPayload = JSON.parse(message.payload)\r\n          if ((aPayload.state === 'ON') || (aPayload.state === 'on')) socket1.iSocket1State = -1\r\n          else {\r\n            if ((aPayload.state === 'OFF') || (aPayload.state === 'off')) socket1.iSocket1State = -2\r\n            else { socket1.iSocket1State = -9 }\r\n          }\r\n        }\r\n        // ---end socket found----------------------------------\r\n      }\r\n    })\r\n  }\r\n\r\n  public publishCi (topic: string, payload: string): void {\r\n    // console.log('CiSocket1Controller:publishCi:', '-t ' + topic + ' -m ' + payload)\r\n    this.publish(topic, payload, false, 0).catch((e) => { console.error('CiSocketController: ERROR:', e) })\r\n  }\r\n}\r\n\r\nexport const ciSocket1Controller = new CiSocket1Controller()\r\n"]}]}