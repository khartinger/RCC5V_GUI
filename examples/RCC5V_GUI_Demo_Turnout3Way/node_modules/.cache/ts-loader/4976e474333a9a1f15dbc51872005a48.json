{"remainingRequest":"G:\\work3\\vue\\haus2\\node_modules\\thread-loader\\dist\\cjs.js!G:\\work3\\vue\\haus2\\node_modules\\ts-loader\\index.js??ref--13-2!G:\\work3\\vue\\haus2\\src\\controller\\CiButtonController.ts","dependencies":[{"path":"G:\\work3\\vue\\haus2\\src\\controller\\CiButtonController.ts","mtime":1674496540906},{"path":"G:\\work3\\vue\\haus2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus2\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus2\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSAidHNsaWIiOw0KLy8gX19fX19fQ2lCdXR0b25Db250cm9sbGVyLnRzX19fX19fX19fX19fX19fX19fX2toYXJ0aW5nZXJfX19fXw0KLy8gMjAyMi0wOS0xNDogYWRkIC5jYXRjaCgoZSkgLi4pIHRvIHRoaXMucHVibGlzaA0KaW1wb3J0IHsgcmVhY3RpdmUgfSBmcm9tICd2dWUnOw0KaW1wb3J0IHsgQ2lCYXNlQ29udHJvbGxlciB9IGZyb20gJy4vQ2lCYXNlQ29udHJvbGxlcic7DQp2YXIgQ2lCdXR0b25Db250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgew0KICAgIF9fZXh0ZW5kcyhDaUJ1dHRvbkNvbnRyb2xsZXIsIF9zdXBlcik7DQogICAgZnVuY3Rpb24gQ2lCdXR0b25Db250cm9sbGVyKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsNCiAgICAgICAgX3RoaXMuYnV0dG9ucyA9IHJlYWN0aXZlKFsNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ2JlMWFyMScsDQogICAgICAgICAgICAgICAgbmFtZTogJ0xhbXBlMycsDQogICAgICAgICAgICAgICAgaUJ1dHRvblN0YXRlOiAtOSwNCiAgICAgICAgICAgICAgICBiYXR0ZXJ5OiAnLScsDQogICAgICAgICAgICAgICAgc2hhcGU6ICdyZWN0JywNCiAgICAgICAgICAgICAgICBjb2xvcjogJyM3Nzc3MjInLA0KICAgICAgICAgICAgICAgIHN1YlRvcGljOiAnZTEvYXIvdGFzdGVyLzMvcmV0L3ZvbHRhZ2UnLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnZTEvYXIvbGljaHQvMy9zZXQvbGljaHQnLA0KICAgICAgICAgICAgICAgIHB1YlBheWxvYWQ6ICctMScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWQ6ICdibzJzbDEnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdMYW1wZTEnLA0KICAgICAgICAgICAgICAgIGlCdXR0b25TdGF0ZTogLTksDQogICAgICAgICAgICAgICAgYmF0dGVyeTogJy0nLA0KICAgICAgICAgICAgICAgIHNoYXBlOiAncmVjdCcsDQogICAgICAgICAgICAgICAgLy8gY29sb3I6ICcjNzc3NzIyJywNCiAgICAgICAgICAgICAgICBzdWJUb3BpYzogJ28yL3NsL3Rhc3Rlci8xL3JldC92b2x0YWdlJywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzogJ28yL3NsL2xpY2h0LzEvc2V0L2xpY2h0JywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAnLTEnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlkOiAnYmUxdm9ybzEnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdST0xMTyBeJywNCiAgICAgICAgICAgICAgICBpQnV0dG9uU3RhdGU6IC05LA0KICAgICAgICAgICAgICAgIGJhdHRlcnk6ICctJywNCiAgICAgICAgICAgICAgICBzaGFwZTogJ3VwJywNCiAgICAgICAgICAgICAgICB0ZXh0Q2VudGVyOiAnQVVGJywNCiAgICAgICAgICAgICAgICBzdWJUb3BpYzogJ2UxL3ZvL3JvbGxvL3JldC9tb3RvcicsDQogICAgICAgICAgICAgICAgcHViVG9waWM6ICdlMS92by9yb2xsby9zZXQvbW90b3InLA0KICAgICAgICAgICAgICAgIHB1YlBheWxvYWQ6ICcxJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ2JlMXZvcm8yJywNCiAgICAgICAgICAgICAgICBuYW1lOiAnUk9MTE8gVicsDQogICAgICAgICAgICAgICAgaUJ1dHRvblN0YXRlOiAtOSwNCiAgICAgICAgICAgICAgICBiYXR0ZXJ5OiAnLScsDQogICAgICAgICAgICAgICAgc2hhcGU6ICdkb3duJywNCiAgICAgICAgICAgICAgICB0ZXh0Q2VudGVyOiAnQUInLA0KICAgICAgICAgICAgICAgIHN1YlRvcGljOiAnZTEvdm8vcm9sbG8vcmV0L21vdG9yJywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzogJ2UxL3ZvL3JvbGxvL3NldC9tb3RvcicsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZDogJy0xJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ2ltZ3N0cm9tJywNCiAgICAgICAgICAgICAgICBuYW1lOiAnT0snLA0KICAgICAgICAgICAgICAgIGlCdXR0b25TdGF0ZTogLTksDQogICAgICAgICAgICAgICAgYmF0dGVyeTogJy0nLA0KICAgICAgICAgICAgICAgIHNoYXBlOiAncmVjdCcsDQogICAgICAgICAgICAgICAgdGV4dENlbnRlcjogJ0FrdHVhbGlzaWVyZW4nLA0KICAgICAgICAgICAgICAgIGNvbG9yOiAnIzc3NzcyMicsDQogICAgICAgICAgICAgICAgc3ViVG9waWM6ICdpcC9oL2h1Mi9zdHJvbS9yZXQvcGhvdG9zJywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzogJ2lwL2gvaHUyL3N0cm9tL2dldCcsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZDogJ3Bob3RvcycNCiAgICAgICAgICAgIH0NCiAgICAgICAgXSk7DQogICAgICAgIHJldHVybiBfdGhpczsNCiAgICB9DQogICAgQ2lCdXR0b25Db250cm9sbGVyLnByb3RvdHlwZS5vbk1lc3NhZ2UgPSBmdW5jdGlvbiAobWVzc2FnZSkgew0KICAgICAgICB0aGlzLmJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7DQogICAgICAgICAgICB2YXIgYVN1YlRvcGljID0gYnV0dG9uLnN1YlRvcGljLnNwbGl0KCcgJyk7DQogICAgICAgICAgICBpZiAoYVN1YlRvcGljLmluY2x1ZGVzKG1lc3NhZ2UudG9waWMpKSB7DQogICAgICAgICAgICAgICAgLy8gLS0tYnV0dG9uIGZvdW5kIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaUJ1dHRvbkNvbnRyb2xsZXIub25NZXNzYWdlIHBheWxvYWQ9JywgbWVzc2FnZS5wYXlsb2FkKQ0KICAgICAgICAgICAgICAgIGlmIChidXR0b24uaWQuc3Vic3RyaW5nKDAsIDcpID09PSAnYmUxdm9ybycpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFQYXlsb2FkID0gSlNPTi5wYXJzZShtZXNzYWdlLnBheWxvYWQpOw0KICAgICAgICAgICAgICAgICAgICBidXR0b24uaUJ1dHRvblN0YXRlID0gMTAgKyBhUGF5bG9hZC5tb3RvcjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnRvcGljLmluY2x1ZGVzKCd2b2x0YWdlJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5iYXR0ZXJ5ID0gIiIgKyBtZXNzYWdlLnBheWxvYWQgKyAnJSc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gLS0tdXBkYXRlIGN1cnJlbnQgY291bnRlci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgICAgICAgICBpZiAoYnV0dG9uLmlkLnN1YnN0cmluZygwLCA4KSA9PT0gJ2ltZ3N0cm9tJykgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlLnBheWxvYWQpOw0KICAgICAgICAgICAgICAgICAgICBidXR0b24ubmFtZSA9IG1lc3NhZ2UucGF5bG9hZDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH07DQogICAgQ2lCdXR0b25Db250cm9sbGVyLnByb3RvdHlwZS5wdWJsaXNoQ2kgPSBmdW5jdGlvbiAodG9waWMsIHBheWxvYWQpIHsNCiAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpQnV0dG9uQ29udHJvbGxlcjpwdWJsaXNoQ2k6JywgJy10ICcgKyB0b3BpYyArICcgLW0gJyArIHBheWxvYWQpDQogICAgICAgIHRoaXMucHVibGlzaCh0b3BpYywgcGF5bG9hZCwgZmFsc2UsIDApLmNhdGNoKGZ1bmN0aW9uIChlKSB7IGNvbnNvbGUuZXJyb3IoJ0NpQnV0dG9uQ29udHJvbGxlcjogRVJST1I6JywgZSk7IH0pOw0KICAgIH07DQogICAgcmV0dXJuIENpQnV0dG9uQ29udHJvbGxlcjsNCn0oQ2lCYXNlQ29udHJvbGxlcikpOw0KZXhwb3J0IHsgQ2lCdXR0b25Db250cm9sbGVyIH07DQpleHBvcnQgdmFyIGNpQnV0dG9uQ29udHJvbGxlciA9IG5ldyBDaUJ1dHRvbkNvbnRyb2xsZXIoKTsNCg=="},{"version":3,"file":"G:\\work3\\vue\\haus2\\src\\controller\\CiButtonController.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus2\\src\\controller\\CiButtonController.ts"],"names":[],"mappings":"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","sourcesContent":["// ______CiButtonController.ts___________________khartinger_____\r\n// 2022-09-14: add .catch((e) ..) to this.publish\r\nimport { reactive } from 'vue'\r\nimport { Message } from '@/services/CiMqttClient'\r\nimport { CiBaseController, IBase } from './CiBaseController'\r\n\r\nexport interface Button extends IBase {\r\n  iButtonState: number;\r\n  battery: string;\r\n  shape?: string;\r\n  color?: string;\r\n  textCenter?: string;\r\n  textFooter?: string;\r\n}\r\n\r\nexport class CiButtonController extends CiBaseController {\r\n  public buttons: Array<Button> = reactive(\r\n    [\r\n      {\r\n        id: 'be1ar1',\r\n        name: 'Lampe3',\r\n        iButtonState: -9,\r\n        battery: '-',\r\n        shape: 'rect',\r\n        color: '#777722',\r\n        subTopic: 'e1/ar/taster/3/ret/voltage',\r\n        pubTopic: 'e1/ar/licht/3/set/licht',\r\n        pubPayload: '-1'\r\n      },\r\n      {\r\n        id: 'bo2sl1',\r\n        name: 'Lampe1',\r\n        iButtonState: -9,\r\n        battery: '-',\r\n        shape: 'rect',\r\n        // color: '#777722',\r\n        subTopic: 'o2/sl/taster/1/ret/voltage',\r\n        pubTopic: 'o2/sl/licht/1/set/licht',\r\n        pubPayload: '-1'\r\n      },\r\n      { // Erdgeschoss: Bereich 1, Rollo auf\r\n        id: 'be1voro1',\r\n        name: 'ROLLO ^',\r\n        iButtonState: -9,\r\n        battery: '-',\r\n        shape: 'up',\r\n        textCenter: 'AUF',\r\n        subTopic: 'e1/vo/rollo/ret/motor',\r\n        pubTopic: 'e1/vo/rollo/set/motor',\r\n        pubPayload: '1'\r\n      },\r\n      { // Erdgeschoss: Bereich 1, Rollo ab\r\n        id: 'be1voro2',\r\n        name: 'ROLLO V',\r\n        iButtonState: -9,\r\n        battery: '-',\r\n        shape: 'down',\r\n        textCenter: 'AB',\r\n        subTopic: 'e1/vo/rollo/ret/motor',\r\n        pubTopic: 'e1/vo/rollo/set/motor',\r\n        pubPayload: '-1'\r\n      },\r\n      {\r\n        id: 'imgstrom',\r\n        name: 'OK',\r\n        iButtonState: -9,\r\n        battery: '-',\r\n        shape: 'rect',\r\n        textCenter: 'Aktualisieren',\r\n        color: '#777722',\r\n        subTopic: 'ip/h/hu2/strom/ret/photos',\r\n        pubTopic: 'ip/h/hu2/strom/get',\r\n        pubPayload: 'photos'\r\n      }\r\n    ]\r\n  );\r\n\r\n  public onMessage (message: Message): void {\r\n    this.buttons.forEach(button => {\r\n      const aSubTopic = button.subTopic.split(' ')\r\n      if (aSubTopic.includes(message.topic)) {\r\n        // ---button found ---------------------------------\r\n        // console.log('CiButtonController.onMessage payload=', message.payload)\r\n        if (button.id.substring(0, 7) === 'be1voro') {\r\n          const aPayload = JSON.parse(message.payload)\r\n          button.iButtonState = 10 + aPayload.motor\r\n        } else {\r\n          if (message.topic.includes('voltage')) {\r\n            button.battery = `${message.payload}` + '%'\r\n          }\r\n        }\r\n        // ---update current counter----------------------------\r\n        if (button.id.substring(0, 8) === 'imgstrom') {\r\n          console.log(message.payload)\r\n          button.name = message.payload\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  public publishCi (topic: string, payload: string): void {\r\n    // console.log('CiButtonController:publishCi:', '-t ' + topic + ' -m ' + payload)\r\n    this.publish(topic, payload, false, 0).catch((e) => { console.error('CiButtonController: ERROR:', e) })\r\n  }\r\n}\r\n\r\nexport const ciButtonController = new CiButtonController()\r\n"]}]}