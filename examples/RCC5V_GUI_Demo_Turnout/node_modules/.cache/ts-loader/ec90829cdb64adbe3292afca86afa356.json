{"remainingRequest":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js??ref--13-1!G:\\work3\\vue\\haus3\\src\\controller\\CiLamp1Controller.ts","dependencies":[{"path":"G:\\work3\\vue\\haus3\\src\\controller\\CiLamp1Controller.ts","mtime":1676309180004},{"path":"G:\\work3\\vue\\haus3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSAidHNsaWIiOw0KLy8gX19fX19fQ2lMYW1wMUNvbnRyb2xsZXIudHNfX19fX19fX19fX19fX19fX19fX2toYXJ0aW5nZXJfX19fXw0KLy8gMjAyMS0xMi0yODogbmV3DQovLyAyMDIzLTAxLTMwOiBjaGFuZ2UgYXQgQ2lCYXNlIChhZGQgR2VvLnRzKQ0KaW1wb3J0IHsgcmVhY3RpdmUgfSBmcm9tICd2dWUnOw0KaW1wb3J0IHsgQ2lCYXNlQ29udHJvbGxlciB9IGZyb20gJy4vQ2lCYXNlQ29udHJvbGxlcic7DQp2YXIgQ2lMYW1wMUNvbnRyb2xsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7DQogICAgX19leHRlbmRzKENpTGFtcDFDb250cm9sbGVyLCBfc3VwZXIpOw0KICAgIGZ1bmN0aW9uIENpTGFtcDFDb250cm9sbGVyKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsNCiAgICAgICAgX3RoaXMubGFtcHMxID0gcmVhY3RpdmUoWw0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIC0tLUFyYmVpdHN6aW1tZXItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgICAgICAgICAgaWQ6ICdhcjFfbDEnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdMYW1wZTMnLA0KICAgICAgICAgICAgICAgIGlMYW1wMVN0YXRlOiAtOTksDQogICAgICAgICAgICAgICAgc3ViVG9waWM6ICdlMS9hci9saWNodC8zL3JldC9saWNodCcsDQogICAgICAgICAgICAgICAgcHViVG9waWM6ICdlMS9hci9saWNodC8zL3NldC9saWNodCcsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZDogJ3VtJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ2h1Ml9sMScsDQogICAgICAgICAgICAgICAgbmFtZTogJ0h1ZXR0ZScsDQogICAgICAgICAgICAgICAgaUxhbXAxU3RhdGU6IC05OSwNCiAgICAgICAgICAgICAgICBzdWJUb3BpYzogJ2lwL2gvaHUyL2h1ZXR0ZS9yZXQvc3RhdHVzIGlwL2gvaHUyL2h1ZXR0ZS9yZXQvbGFtcGUnLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnaXAvaC9odTIvaHVldHRlL3NldC9sYW1wZScsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZDogJy0xJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ3NsM19sMScsDQogICAgICAgICAgICAgICAgbmFtZTogJ0xhbXBlMScsDQogICAgICAgICAgICAgICAgaUxhbXAxU3RhdGU6IC05OSwNCiAgICAgICAgICAgICAgICBzdWJUb3BpYzogJ28yL3NsL2xpY2h0LzEvcmV0L2xpY2h0JywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzogJ28yL3NsL2xpY2h0LzEvc2V0L2xpY2h0JywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAnLTEnDQogICAgICAgICAgICB9DQogICAgICAgIF0pOw0KICAgICAgICByZXR1cm4gX3RoaXM7DQogICAgfQ0KICAgIENpTGFtcDFDb250cm9sbGVyLnByb3RvdHlwZS5vbk1lc3NhZ2UgPSBmdW5jdGlvbiAobWVzc2FnZSkgew0KICAgICAgICB0aGlzLmxhbXBzMS5mb3JFYWNoKGZ1bmN0aW9uIChsYW1wMSkgew0KICAgICAgICAgICAgdmFyIGFTdWJUb3BpYyA9IGxhbXAxLnN1YlRvcGljLnNwbGl0KCcgJyk7DQogICAgICAgICAgICBpZiAoYVN1YlRvcGljLmluY2x1ZGVzKG1lc3NhZ2UudG9waWMpKSB7DQogICAgICAgICAgICAgICAgLy8gLS0tbGFtcDEgdG9waWMgZm91bmQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS50b3BpYy5pbmNsdWRlcygncmV0L3N0YXR1cycpKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIC1sYW1wIHN0YXRlIGZyb20gaHVldHRlIC0gc3RhdHVzLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2lMYW1wQ29udHJvbGxlci5vbk1lc3NhZ2UgLXQgJywgbWVzc2FnZS50b3BpYyArICcgLW0gJyArIG1lc3NhZ2UucGF5bG9hZCkNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFQYXlsb2FkID0gSlNPTi5wYXJzZShtZXNzYWdlLnBheWxvYWQpOw0KICAgICAgICAgICAgICAgICAgICBsYW1wMS5pTGFtcDFTdGF0ZSA9IC0xOw0KICAgICAgICAgICAgICAgICAgICBpZiAoYVBheWxvYWQuTGFtcCA9PT0gMCB8fCBhUGF5bG9hZC5MYW1wID09PSAnMCcpDQogICAgICAgICAgICAgICAgICAgICAgICBsYW1wMS5pTGFtcDFTdGF0ZSA9IC0yOw0KICAgICAgICAgICAgICAgICAgICBpZiAoYVBheWxvYWQuTGFtcCA9PT0gMSB8fCBhUGF5bG9hZC5MYW1wID09PSAnMScpDQogICAgICAgICAgICAgICAgICAgICAgICBsYW1wMS5pTGFtcDFTdGF0ZSA9IC0xOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gLW90aGVyIGxhbXAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgICAgICAgICAgICAgIGlmICgobWVzc2FnZS5wYXlsb2FkID09PSAnMScpIHx8IChtZXNzYWdlLnBheWxvYWQgPT09ICdvbicpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgbGFtcDEuaUxhbXAxU3RhdGUgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKG1lc3NhZ2UucGF5bG9hZCA9PT0gJzAnKSB8fCAobWVzc2FnZS5wYXlsb2FkID09PSAnb2ZmJykpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFtcDEuaUxhbXAxU3RhdGUgPSAtMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbXAxLmlMYW1wMVN0YXRlID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gLS0tZW5kIGxhbXAxIHRvcGljIGZvdW5kIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsNCiAgICBDaUxhbXAxQ29udHJvbGxlci5wcm90b3R5cGUucHVibGlzaENpID0gZnVuY3Rpb24gKHRvcGljLCBwYXlsb2FkKSB7DQogICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaUxhbXAxQ29udHJvbGxlcjpwdWJsaXNoQ2k6JywgJy10ICcgKyB0b3BpYyArICcgLW0gJyArIHBheWxvYWQpDQogICAgICAgIHRoaXMucHVibGlzaCh0b3BpYywgcGF5bG9hZCwgZmFsc2UsIDApLmNhdGNoKGZ1bmN0aW9uIChlKSB7IGNvbnNvbGUuZXJyb3IoJ0NpTGFtcDFDb250cm9sbGVyOiBFUlJPUjonLCBlKTsgfSk7DQogICAgfTsNCiAgICByZXR1cm4gQ2lMYW1wMUNvbnRyb2xsZXI7DQp9KENpQmFzZUNvbnRyb2xsZXIpKTsNCmV4cG9ydCB7IENpTGFtcDFDb250cm9sbGVyIH07DQpleHBvcnQgdmFyIGNpTGFtcDFDb250cm9sbGVyID0gbmV3IENpTGFtcDFDb250cm9sbGVyKCk7DQo="},{"version":3,"file":"G:\\work3\\vue\\haus3\\src\\controller\\CiLamp1Controller.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus3\\src\\controller\\CiLamp1Controller.ts"],"names":[],"mappings":"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","sourcesContent":["// ______CiLamp1Controller.ts____________________khartinger_____\r\n// 2021-12-28: new\r\n// 2023-01-30: change at CiBase (add Geo.ts)\r\nimport { reactive } from 'vue'\r\nimport { Message } from '@/services/CiMqttClient'\r\nimport { CiBaseController, IBase } from './CiBaseController'\r\n\r\nexport interface Lamp1 extends IBase {\r\n  iLamp1State: number;\r\n  battery?: string;\r\n  textCenter?: string;\r\n  textFooter?: string;\r\n}\r\n\r\nexport class CiLamp1Controller extends CiBaseController {\r\n  public lamps1: Array<Lamp1> = reactive(\r\n    [\r\n      {\r\n        // ---Arbeitszimmer-------------------------------------\r\n        id: 'ar1_l1',\r\n        name: 'Lampe3',\r\n        iLamp1State: -99,\r\n        subTopic: 'e1/ar/licht/3/ret/licht',\r\n        pubTopic: 'e1/ar/licht/3/set/licht',\r\n        pubPayload: 'um'\r\n      },\r\n      { // ---Huette--------------------------------------------\r\n        id: 'hu2_l1',\r\n        name: 'Huette',\r\n        iLamp1State: -99,\r\n        subTopic: 'ip/h/hu2/huette/ret/status ip/h/hu2/huette/ret/lampe',\r\n        pubTopic: 'ip/h/hu2/huette/set/lampe',\r\n        pubPayload: '-1'\r\n      },\r\n      { // ---Schlafzimmer 1. Stock-----------------------------\r\n        id: 'sl3_l1',\r\n        name: 'Lampe1',\r\n        iLamp1State: -99,\r\n        subTopic: 'o2/sl/licht/1/ret/licht',\r\n        pubTopic: 'o2/sl/licht/1/set/licht',\r\n        pubPayload: '-1'\r\n      }\r\n    ]\r\n  );\r\n\r\n  public onMessage (message: Message): void {\r\n    this.lamps1.forEach(lamp1 => {\r\n      const aSubTopic = lamp1.subTopic.split(' ')\r\n      if (aSubTopic.includes(message.topic)) {\r\n        // ---lamp1 topic found --------------------------------\r\n        if (message.topic.includes('ret/status')) {\r\n          // -lamp state from huette - status-------------------\r\n          // console.log('CiLampController.onMessage -t ', message.topic + ' -m ' + message.payload)\r\n          const aPayload = JSON.parse(message.payload)\r\n          lamp1.iLamp1State = -1\r\n          if (aPayload.Lamp === 0 || aPayload.Lamp === '0') lamp1.iLamp1State = -2\r\n          if (aPayload.Lamp === 1 || aPayload.Lamp === '1') lamp1.iLamp1State = -1\r\n        } else {\r\n          // -other lamp----------------------------------------\r\n          if ((message.payload === '1') || (message.payload === 'on')) lamp1.iLamp1State = -1\r\n          else {\r\n            if ((message.payload === '0') || (message.payload === 'off')) lamp1.iLamp1State = -2\r\n            else { lamp1.iLamp1State = -1 }\r\n          }\r\n        }\r\n        // ---end lamp1 topic found ----------------------------\r\n      }\r\n    })\r\n  }\r\n\r\n  public publishCi (topic: string, payload: string): void {\r\n    // console.log('CiLamp1Controller:publishCi:', '-t ' + topic + ' -m ' + payload)\r\n    this.publish(topic, payload, false, 0).catch((e) => { console.error('CiLamp1Controller: ERROR:', e) })\r\n  }\r\n}\r\n\r\nexport const ciLamp1Controller = new CiLamp1Controller()\r\n"]}]}