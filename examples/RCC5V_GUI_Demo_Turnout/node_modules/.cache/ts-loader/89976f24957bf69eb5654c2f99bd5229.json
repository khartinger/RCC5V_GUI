{"remainingRequest":"G:\\work3\\vue\\haus2\\node_modules\\thread-loader\\dist\\cjs.js!G:\\work3\\vue\\haus2\\node_modules\\ts-loader\\index.js??ref--13-2!G:\\work3\\vue\\haus2\\src\\services\\CiMqttClient.ts","dependencies":[{"path":"G:\\work3\\vue\\haus2\\src\\services\\CiMqttClient.ts","mtime":1672657674404},{"path":"G:\\work3\\vue\\haus2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus2\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus2\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19hd2FpdGVyLCBfX2dlbmVyYXRvciB9IGZyb20gInRzbGliIjsNCi8vIF9fX19fX0NpTXF0dENsaWVudC50c19fX19fX19fX19fX19fX19fX19fX19fX19raGFydGluZ2VyX19fX18NCi8vIDIwMjEtMTItMjY6IG5ldw0KaW1wb3J0IG1xdHQgZnJvbSAnbXF0dCc7DQppbXBvcnQgeyByZWFjdGl2ZSwgcmVhZG9ubHkgfSBmcm9tICd2dWUnOw0KLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KLy8gY2xhc3MgQ2lNcXR0Q2xpZW50DQovLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQp2YXIgQ2lNcXR0Q2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgew0KICAgIC8vID09PT09PT09PW1ldGhvZHM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogICAgLy8gX19fX19fX19fY29uc3RydWN0b3JfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18NCiAgICBmdW5jdGlvbiBDaU1xdHRDbGllbnQoY29ubmVjdE9uU3RhcnQpIHsNCiAgICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgICAgLy8gLS0tLS0tLS0tYmFzaWMgcHJvcGVydGllcy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgdGhpcy5jbGllbnQgPSBudWxsOw0KICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBbXTsNCiAgICAgICAgdGhpcy5zdWJUb3BpYyA9ICcjJzsNCiAgICAgICAgdGhpcy5zdWJRb3MgPSAwOw0KICAgICAgICAvLyAtLS0tLS0tLS1zb21lIG1vcmUgcHJvcGVydGllcyAoaW50ZXJmYWNlcyktLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAvLyBUbyBwcmV2ZW50IHZhbHVlcyBmcm9tIGJlaW5nIGNoYW5nZWQgYnkgbWlzdGFrZSwNCiAgICAgICAgLy8gdGhlcmUgaXMgYWx3YXlzIGEgcHJpdmF0ZSBhbmQgYSBwdWJsaWMgdmFyaWFudC4NCiAgICAgICAgdGhpcy5wcml2YXRlTXF0dFN0YXRlID0gcmVhY3RpdmUoew0KICAgICAgICAgICAgY29ubmVjdE9uU3RhcnQ6IGZhbHNlLA0KICAgICAgICAgICAgY29ubmVjdGVkOiBmYWxzZSwNCiAgICAgICAgICAgIGlDb25uTXF0dFN0YXRlOiAtMSwNCiAgICAgICAgICAgIG1lc3NhZ2U6IHsgdG9waWM6ICcnLCBwYXlsb2FkOiAnJywgcmV0YWluOiBmYWxzZSwgcW9zOiAwIH0NCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMubXF0dFN0YXRlID0gcmVhZG9ubHkodGhpcy5wcml2YXRlTXF0dFN0YXRlKTsNCiAgICAgICAgdGhpcy5wcml2YXRlTXF0dENvbm5lY3Rpb24gPSByZWFjdGl2ZSh7DQogICAgICAgICAgICBob3N0OiAnMTkyLjE2OC4wLjcnLA0KICAgICAgICAgICAgcG9ydDogMTg4NCwNCiAgICAgICAgICAgIGVuZHBvaW50OiAnJywNCiAgICAgICAgICAgIGNsZWFuOiB0cnVlLA0KICAgICAgICAgICAgY29ubmVjdFRpbWVvdXQ6IDQwMDAsDQogICAgICAgICAgICByZWNvbm5lY3RQZXJpb2Q6IDQwMDAsDQogICAgICAgICAgICBjbGllbnRJZDogJycsDQogICAgICAgICAgICB1c2VybmFtZTogJycsDQogICAgICAgICAgICBwYXNzd29yZDogJycNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMubXF0dENvbm5lY3Rpb24gPSByZWFkb25seSh0aGlzLnByaXZhdGVNcXR0Q29ubmVjdGlvbik7DQogICAgICAgIHRoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24gPSByZWFjdGl2ZSh7DQogICAgICAgICAgICB0b3BpYzogJyMnLA0KICAgICAgICAgICAgcW9zOiAwLA0KICAgICAgICAgICAgc3Vic2NyaWJlZDogZmFsc2UNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMubXF0dFN1YnNjcmlwdGlvbiA9IHJlYWRvbmx5KHRoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24pOw0KICAgICAgICB0aGlzLnByaXZhdGVNcXR0U3RhdGUuY29ubmVjdE9uU3RhcnQgPSBjb25uZWN0T25TdGFydDsNCiAgICAgICAgY29uc29sZS5sb2coJ01xdHRDbGllbnQtQ29uc3RydWN0b3I6IHByaXZhdGVNcXR0U3RhdGUuY29ubmVjdE9uU3RhcnQgPSAnLCB0aGlzLnByaXZhdGVNcXR0U3RhdGUuY29ubmVjdE9uU3RhcnQpOw0KICAgICAgICBpZiAodGhpcy5wcml2YXRlTXF0dFN0YXRlLmNvbm5lY3RPblN0YXJ0KSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnTXF0dENsaWVudC1Db25zdHJ1Y3RvcjogY29ubmVjdGluZyB0byAnICsgdGhpcy5jb25uZWN0VXJsKCkpOw0KICAgICAgICAgICAgdGhpcy5jb25uZWN0XygpLnRoZW4oZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIF90aGlzLnN1YlRvcGljID0gX3RoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24udG9waWM7DQogICAgICAgICAgICAgICAgX3RoaXMuc3ViUW9zID0gX3RoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24ucW9zOw0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNcXR0Q2xpZW50LUNvbnN0cnVjdG9yOiBzdWJzY3JpYmUgJyArIF90aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnRvcGljKTsNCiAgICAgICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmVfKCkuY2F0Y2goZnVuY3Rpb24gKGUpIHsgY29uc29sZS5lcnJvcignTXF0dENsaWVudC1jb25zdHJ1Y3RvcjogU3ViY3JpYmUgRVJST1I6JywgZSk7IH0pOw0KICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsgY29uc29sZS5lcnJvcignTXF0dENsaWVudC1jb25zdHJ1Y3RvcjogQ29ubmVjdCBFUlJPUjonLCBlKTsgfSk7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnTXF0dENsaWVudC1jb25zdHJ1Y3RvcjogZmluaXNoZWQnKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICAvLyBfX19fX19fX19jb25uZWN0IHVybCBsaWtlIDEwLjEuMS4xOjE4ODRfX19fX19fX19fX19fX19fX19fXw0KICAgIENpTXF0dENsaWVudC5wcm90b3R5cGUuY29ubmVjdFVybCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgcmV0dXJuICJ3czovLyIgKyB0aGlzLm1xdHRDb25uZWN0aW9uLmhvc3QgKyAiOiIgKyB0aGlzLm1xdHRDb25uZWN0aW9uLnBvcnQgKyB0aGlzLm1xdHRDb25uZWN0aW9uLmVuZHBvaW50Ow0KICAgIH07DQogICAgLy8gX19fX19fX19fcHVibGljIHZhcmlhbnQ6IGNvbm5lY3QgdG8gc2VydmVyIChicm9rZXIpX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAoaG9zdCwgcG9ydCwgZW5kcG9pbnQpIHsNCiAgICAgICAgdGhpcy5wcml2YXRlTXF0dENvbm5lY3Rpb24uaG9zdCA9IGhvc3Q7DQogICAgICAgIHRoaXMucHJpdmF0ZU1xdHRDb25uZWN0aW9uLnBvcnQgPSBwb3J0Ow0KICAgICAgICB0aGlzLnByaXZhdGVNcXR0Q29ubmVjdGlvbi5lbmRwb2ludCA9IGVuZHBvaW50Ow0KICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0XygpOw0KICAgIH07DQogICAgLy8gX19fX19fX19fcHJpdmF0ZSB2YXJpYW50OiBjb25uZWN0IHRvIHNlcnZlciAoYnJva2VyKV9fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLmNvbm5lY3RfID0gZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICAgICAgaWYgKF90aGlzLmNsaWVudCkNCiAgICAgICAgICAgICAgICBfdGhpcy5kaXNjb25uZWN0KCkuY2F0Y2goZnVuY3Rpb24gKGUpIHsgY29uc29sZS5lcnJvcignTXF0dENsaWVudC1jb25uZWN0XzogRVJST1Igd2hpbGUgZGlzY29ubmVjdGluZzonLCBlKTsgfSk7DQogICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmlDb25uTXF0dFN0YXRlID0gMjsNCiAgICAgICAgICAgIHZhciBvcHRpb25zXyA9IHsNCiAgICAgICAgICAgICAgICBjbGVhbjogX3RoaXMubXF0dENvbm5lY3Rpb24uY2xlYW4sDQogICAgICAgICAgICAgICAgY29ubmVjdFRpbWVvdXQ6IF90aGlzLm1xdHRDb25uZWN0aW9uLmNvbm5lY3RUaW1lb3V0LA0KICAgICAgICAgICAgICAgIHJlY29ubmVjdFBlcmlvZDogX3RoaXMubXF0dENvbm5lY3Rpb24ucmVjb25uZWN0UGVyaW9kLA0KICAgICAgICAgICAgICAgIGNsaWVudElkOiBfdGhpcy5tcXR0Q29ubmVjdGlvbi5jbGllbnRJZCwNCiAgICAgICAgICAgICAgICB1c2VybmFtZTogX3RoaXMubXF0dENvbm5lY3Rpb24udXNlcm5hbWUsDQogICAgICAgICAgICAgICAgcGFzc3dvcmQ6IF90aGlzLm1xdHRDb25uZWN0aW9uLnBhc3N3b3JkDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgY29uc29sZS5sb2coJ01xdHRDaWVudC50cy1jb25uZWN0OiB1cmw9JyArIF90aGlzLmNvbm5lY3RVcmwoKSk7DQogICAgICAgICAgICB2YXIgY2xpZW50ID0gbXF0dC5jb25uZWN0KF90aGlzLmNvbm5lY3RVcmwoKSwgb3B0aW9uc18pOw0KICAgICAgICAgICAgX3RoaXMuY2xpZW50ID0gY2xpZW50Ow0KICAgICAgICAgICAgX3RoaXMuY2xpZW50Lm9uKCdjb25uZWN0JywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuY29ubmVjdGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmlDb25uTXF0dFN0YXRlID0gMTsNCiAgICAgICAgICAgICAgICBjbGllbnQub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycikgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNUVRUIEVycm9yJywgZXJyKTsNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdGF0ZS5pQ29ubk1xdHRTdGF0ZSA9IDc7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgY2xpZW50Lm9uKCdjb25uZWN0aW5nJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNUVRUIENvbm5lY3RpbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdGF0ZS5pQ29ubk1xdHRTdGF0ZSA9IDI7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgY2xpZW50Lm9uKCdvZmZsaW5lJywgZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuY29ubmVjdGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnN1YnNjcmliZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTVFUVCBPZmZsaW5lJywgdmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmlDb25uTXF0dFN0YXRlID0gMzsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBjbGllbnQub24oJ2Rpc2Nvbm5lY3QnLCBmdW5jdGlvbiAodmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTVFUVCBEaXNjb25uZWN0JywgdmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmlDb25uTXF0dFN0YXRlID0gMDsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBjbGllbnQub24oJ2VuZCcsIGZ1bmN0aW9uICh2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmNvbm5lY3RlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01xdHRDbGllbnQudHMtZW5kOiB2YWx1ZT0nLCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3RhdGUuaUNvbm5NcXR0U3RhdGUgPSA5Ow0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGNsaWVudC5vbignbWVzc2FnZScsIGZ1bmN0aW9uICh0b3BpYywgcGF5bG9hZCwgcHJvcHMxKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciByZXRhaW4xID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXRhaW4xID0gcHJvcHMxLnJldGFpbjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHZhciBxb3MxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFvczEgPSBwcm9wczEucW9zOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29udHJvbGxlci5mb3JFYWNoKGZ1bmN0aW9uIChjb250cm9sbGVyKSB7IHJldHVybiBjb250cm9sbGVyLm9uTWVzc2FnZSh7DQogICAgICAgICAgICAgICAgICAgICAgICB0b3BpYzogdG9waWMsDQogICAgICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBwYXlsb2FkLnRvU3RyaW5nKCksDQogICAgICAgICAgICAgICAgICAgICAgICByZXRhaW46IHJldGFpbjEsDQogICAgICAgICAgICAgICAgICAgICAgICBxb3M6IHFvczENCiAgICAgICAgICAgICAgICAgICAgfSk7IH0pOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHJlc29sdmUoKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgY2xpZW50Lm9uKCdlcnJvcicsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBvbiBjb25uZWN0aW5nLi4uJyk7DQogICAgICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdGF0ZS5pQ29ubk1xdHRTdGF0ZSA9IDg7DQogICAgICAgICAgICAgICAgcmVqZWN0KEVycm9yKCdFcnJvcicpKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIC8vIF9fX19fX19fX2Rpc2Nvbm5lY3QgZnJvbSBicm9rZXJfX19fX19fX19fX19fX19fX19fX19fX19fX19fDQogICAgQ2lNcXR0Q2xpZW50LnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICAgICAgaWYgKCFfdGhpcy5jbGllbnQpDQogICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ05vdCBDb25uZWN0ZWQnKSk7DQogICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN0YXRlLmlDb25uTXF0dFN0YXRlID0gOTsNCiAgICAgICAgICAgIF90aGlzLmNsaWVudC5lbmQodHJ1ZSwge30sIGZ1bmN0aW9uIChlcnIpIHsNCiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaU1xdHRDbGllbnQ6ZGlzY29ubmVjdDogJywgJ2ZhaWxlZCEnKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignQ291bGQgbm90IGRpc2Nvbm5lY3QnKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaU1xdHRDbGllbnQ6ZGlzY29ubmVjdDogJywgJ3N1Y2Nlc3MhJykNCiAgICAgICAgICAgICAgICByZXNvbHZlKCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgfTsNCiAgICAvLyBfX19fX19fX19wdWJsaWMgdmFyaWFudDogc3Vic2NyaWJlIHRvcGljX19fX19fX19fX19fX19fX19fXw0KICAgIENpTXF0dENsaWVudC5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHRvcGljLCBxb3MpIHsNCiAgICAgICAgdGhpcy5zdWJUb3BpYyA9IHRvcGljOw0KICAgICAgICB0aGlzLnN1YlFvcyA9IHFvczsNCiAgICAgICAgcmV0dXJuIHRoaXMuc3Vic2NyaWJlXygpOw0KICAgIH07DQogICAgLy8gX19fX19fX19fcHJpdmF0ZSB2YXJpYW50OiBzdWJzY3JpYmUgdG9waWNfX19fX19fX19fX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLnN1YnNjcmliZV8gPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBpZiAoIV90aGlzLmNsaWVudCkgew0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaU1xdHRDbGllbnQ6c3Vic2NyaWJlOiBmYWlsZWQgLSBub3QgY29ubmVjdGVkISAnICsgdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYykNCiAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignc3Vic2NyaWJlOiBOb3QgQ29ubmVjdGVkJykpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgX3RoaXMudW5zdWJzY3JpYmUoKS5jYXRjaChmdW5jdGlvbiAoZSkgeyBjb25zb2xlLmVycm9yKCdNcXR0Q2xpZW50LXN1YnNjcmliZV86IEVSUk9SOicsIGUpOyB9KTsNCiAgICAgICAgICAgIF90aGlzLmNsaWVudC5zdWJzY3JpYmUoX3RoaXMuc3ViVG9waWMsIHsgcW9zOiBfdGhpcy5zdWJRb3MgfSwgZnVuY3Rpb24gKGVycikgew0KICAgICAgICAgICAgICAgIGlmIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpTXF0dENsaWVudDpzdWJzY3JpYmU6IGZhaWxlZCEgJyArIHRoaXMuc3ViVG9waWMpDQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdDb3VsZCBub3Qgc3Vic2NyaWJlIHRvcGljICcgKyBfdGhpcy5zdWJUb3BpYykpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBfdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYyA9IF90aGlzLnN1YlRvcGljOw0KICAgICAgICAgICAgICAgIF90aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnFvcyA9IF90aGlzLnN1YlFvczsNCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2lNcXR0Q2xpZW50OnN1YnNjcmliZTogc3VjY2VzcyEgJyArIHRoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24udG9waWMpDQogICAgICAgICAgICAgICAgcmVzb2x2ZSgpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgIH07DQogICAgLy8gX19fX19fX19fdW5zdWJzY3JpYmUgdG9waWNfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICAgICAgdmFyIHN1YnNjcmliZWRPbGQgPSBfdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkOw0KICAgICAgICAgICAgX3RoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24uc3Vic2NyaWJlZCA9IGZhbHNlOw0KICAgICAgICAgICAgaWYgKCFfdGhpcy5jbGllbnQpIHsNCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2lNcXR0Q2xpZW50OnVuc3Vic2NyaWJlOiBmYWlsZWQgLSBub3QgY29ubmVjdGVkISAnLCB0aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnRvcGljKQ0KICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdOb3QgQ29ubmVjdGVkJykpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHN1YnNjcmliZWRPbGQpIHsNCiAgICAgICAgICAgICAgICBfdGhpcy5jbGllbnQudW5zdWJzY3JpYmUoX3RoaXMucHJpdmF0ZU1xdHRTdWJzY3JpcHRpb24udG9waWMsIHt9LCBmdW5jdGlvbiAoZXJyKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaU1xdHRDbGllbnQ6dW5zdWJzY3JpYmU6IGZhaWxlZCEgJywgdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYykNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdDb3VsZCBub3QgdW5zdWJzY3JpYmUgdG9waWMgJyArIF90aGlzLnByaXZhdGVNcXR0U3Vic2NyaXB0aW9uLnRvcGljKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0NpTXF0dENsaWVudDp1bnN1YnNjcmliZTogc3VjY2VzcyEgJywgdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYykNCiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIC8vIF9fX19fX19fX3B1Ymxpc2ggYSBtZXNzYWdlX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fDQogICAgQ2lNcXR0Q2xpZW50LnByb3RvdHlwZS5wdWJsaXNoID0gZnVuY3Rpb24gKHRvcGljLCBwYXlsb2FkLCByZXRhaW4sIHFvcykgew0KICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICAgICAgaWYgKCFfdGhpcy5jbGllbnQpDQogICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ05vdCBDb25uZWN0ZWQnKSk7DQogICAgICAgICAgICBfdGhpcy5jbGllbnQucHVibGlzaCh0b3BpYywgcGF5bG9hZCwgeyBxb3M6IHFvcywgcmV0YWluOiByZXRhaW4gfSwgZnVuY3Rpb24gKGVycikgew0KICAgICAgICAgICAgICAgIGlmIChlcnIpDQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdDb3VsZCBub3QgcHVibGlzaCB0b3BpYyAnICsgdG9waWMpKTsNCiAgICAgICAgICAgICAgICByZXNvbHZlKCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgfTsNCiAgICAvLyBfX19fX19fX19yZXR1cm4gbXF0dCBjb25uZWN0aW9uIHN0YXRlIGFzIHN0cmluZ19fX19fX19fX19fXw0KICAgIENpTXF0dENsaWVudC5wcm90b3R5cGUuc0Nvbm5NcXR0U3RhdGUgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHN3aXRjaCAodGhpcy5tcXR0U3RhdGUuaUNvbm5NcXR0U3RhdGUpIHsNCiAgICAgICAgICAgIGNhc2UgLTE6IHJldHVybiAnbm90IGNvbm5lY3RlZCc7DQogICAgICAgICAgICBjYXNlIDA6IHJldHVybiAnZGlzY29ubmVjdGVkJzsNCiAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuICdjb25uZWN0ZWQnOw0KICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gJ2Nvbm5lY3RpbmcgdG8gJyArIHRoaXMuY29ubmVjdFVybCgpOw0KICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gJ29mZmxpbmUnOw0KICAgICAgICAgICAgY2FzZSA3OiByZXR1cm4gJ21xdHQgZXJyb3InOw0KICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gJ3RpbWVvdXQnOw0KICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gJ2VuZCBjb25uZWN0ZWQnOw0KICAgICAgICAgICAgZGVmYXVsdDogYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICd1bmRlZmluZWQnOw0KICAgIH07DQogICAgLy8gX19fX19fX19fY29ubmVjdCB0byBhIGJyb2tlciBhbmQgc3Vic2NyaWJlIGEgdG9waWNfX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLmhvc3RTdWJzY3JpYmUgPSBmdW5jdGlvbiAoaG9zdCwgdG9waWNTdWJzY3JpYmUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIFByb21pc2UsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBlcnJfMTsNCiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHsNCiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdmF0ZU1xdHRDb25uZWN0aW9uLmhvc3QgPSBob3N0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2YXRlTXF0dFN1YnNjcmlwdGlvbi50b3BpYyA9IHRvcGljU3Vic2NyaWJlOw0KICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIDE6DQogICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDQsICwgNV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jb25uZWN0XygpXTsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOg0KICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zdWJzY3JpYmVfKCldOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIDM6DQogICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA1XTsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSA0Og0KICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzEgPSBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDaU1xdHRDbGllbnQuaG9zdFN1YnNjcmliZTogRXJyb3IgJyArIGVycl8xKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBmYWxzZV07DQogICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRydWVdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIC8vIF9fX19fX19fX21ldGhvZCB0byByZWdpc3RlciBjb250cm9sbGVyX19fX19fX19fX19fX19fX19fX19fDQogICAgQ2lNcXR0Q2xpZW50LnByb3RvdHlwZS5yZWdpc3RlckNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoY29udHJvbGxlcikgew0KICAgICAgICB0aGlzLmNvbnRyb2xsZXIucHVzaChjb250cm9sbGVyKTsNCiAgICAgICAgY29udHJvbGxlci5yZWdpc3RlckNsaWVudCh0aGlzKTsNCiAgICB9Ow0KICAgIC8vIF9fX19fX19fX3JlY29ubmVjdCB0byBicm9rZXIgd2l0aCBkZWZhdWx0IHZhbHVlc19fX19fX19fX19fDQogICAgQ2lNcXR0Q2xpZW50LnByb3RvdHlwZS5yZWNvbm5lY3RCcm9rZXIgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCBQcm9taXNlLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgZXJyXzI7DQogICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7DQogICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkgew0KICAgICAgICAgICAgICAgICAgICBjYXNlIDA6DQogICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzAsIDMsICwgNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jb25uZWN0XygpXTsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zdWJzY3JpYmVfKCldOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOg0KICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzIgPSBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDaU1xdHRDbGllbnQucmVjb25uZWN0QnJva2VyOiBFcnJvciAnICsgZXJyXzIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGZhbHNlXTsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgdHJ1ZV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgIH07DQogICAgLy8gX19fX19fX19fbm90aGluZyB0byBkby4uLl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18NCiAgICBDaU1xdHRDbGllbnQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCdDaU1xdHRDbGllbnQuaW5pdCcpOw0KICAgIH07DQogICAgcmV0dXJuIENpTXF0dENsaWVudDsNCn0oKSk7DQpleHBvcnQgeyBDaU1xdHRDbGllbnQgfTsNCg=="},{"version":3,"file":"G:\\work3\\vue\\haus2\\src\\services\\CiMqttClient.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus2\\src\\services\\CiMqttClient.ts"],"names":[],"mappings":";AAAA,gEAAgE;AAChE,kBAAkB;AAClB,OAAO,IAAa,MAAM,MAAM,CAAA;AAEhC,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,KAAK,CAAA;AA0CxC,gEAAgE;AAChE,qBAAqB;AACrB,gEAAgE;AAEhE;IA0CE,8DAA8D;IAC9D,8DAA8D;IAC9D,sBAAa,cAAuB;QAApC,iBAaC;QAxDD,8DAA8D;QACvD,WAAM,GAAuB,IAAI,CAAC;QAClC,eAAU,GAA4B,EAAE,CAAC;QAExC,aAAQ,GAAG,GAAG,CAAC;QACf,WAAM,GAAQ,CAAC,CAAC;QAExB,8DAA8D;QAC9D,mDAAmD;QACnD,kDAAkD;QAC1C,qBAAgB,GAAc,QAAQ,CAAY;YACxD,cAAc,EAAE,KAAK;YACrB,SAAS,EAAE,KAAK;YAChB,cAAc,EAAE,CAAC,CAAC;YAClB,OAAO,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,EAAE;SAC3D,CAAC,CAAA;QAEK,cAAS,GAAG,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA;QAE1C,0BAAqB,GAAmB,QAAQ,CAAiB;YACvE,IAAI,EAAE,aAAa;YACnB,IAAI,EAAE,IAAI;YACV,QAAQ,EAAE,EAAE;YACZ,KAAK,EAAE,IAAI;YACX,cAAc,EAAE,IAAI;YACpB,eAAe,EAAE,IAAI;YACrB,QAAQ,EAAE,EAAE;YACZ,QAAQ,EAAE,EAAE;YACZ,QAAQ,EAAE,EAAE;SACb,CAAC,CAAA;QAEK,mBAAc,GAAG,QAAQ,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAA;QAEpD,4BAAuB,GAAqB,QAAQ,CAAmB;YAC7E,KAAK,EAAE,GAAG;YACV,GAAG,EAAE,CAAC;YACN,UAAU,EAAE,KAAK;SAClB,CAAC,CAAA;QAEK,qBAAgB,GAAG,QAAQ,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAA;QAK9D,IAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,cAAc,CAAA;QACrD,OAAO,CAAC,GAAG,CAAC,4DAA4D,EAAE,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAA;QAC/G,IAAI,IAAI,CAAC,gBAAgB,CAAC,cAAc,EAAE;YACxC,OAAO,CAAC,GAAG,CAAC,wCAAwC,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC,CAAA;YACzE,IAAI,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC;gBACnB,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,uBAAuB,CAAC,KAAK,CAAA;gBAClD,KAAI,CAAC,MAAM,GAAG,KAAI,CAAC,uBAAuB,CAAC,GAAG,CAAA;gBAC9C,OAAO,CAAC,GAAG,CAAC,oCAAoC,GAAG,KAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAA;gBACtF,KAAI,CAAC,UAAU,EAAE,CAAC,KAAK,CAAC,UAAC,CAAC,IAAO,OAAO,CAAC,KAAK,CAAC,yCAAyC,EAAE,CAAC,CAAC,CAAA,CAAC,CAAC,CAAC,CAAA;YACjG,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,CAAC,IAAO,OAAO,CAAC,KAAK,CAAC,wCAAwC,EAAE,CAAC,CAAC,CAAA,CAAC,CAAC,CAAC,CAAA;YAC/E,OAAO,CAAC,GAAG,CAAC,kCAAkC,CAAC,CAAA;SAChD;IACH,CAAC;IAED,8DAA8D;IACvD,iCAAU,GAAjB;QACE,OAAO,UAAQ,IAAI,CAAC,cAAc,CAAC,IAAI,SAAI,IAAI,CAAC,cAAc,CAAC,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,QAAU,CAAA;IACtG,CAAC;IAED,8DAA8D;IACvD,8BAAO,GAAd,UAAgB,IAAY,EAAE,IAAY,EAAE,QAAgB;QAC1D,IAAI,CAAC,qBAAqB,CAAC,IAAI,GAAG,IAAI,CAAA;QACtC,IAAI,CAAC,qBAAqB,CAAC,IAAI,GAAG,IAAI,CAAA;QACtC,IAAI,CAAC,qBAAqB,CAAC,QAAQ,GAAG,QAAQ,CAAA;QAC9C,OAAO,IAAI,CAAC,QAAQ,EAAE,CAAA;IACxB,CAAC;IAED,8DAA8D;IACtD,+BAAQ,GAAhB;QAAA,iBAkEC;QAjEC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YACjC,IAAI,KAAI,CAAC,MAAM;gBAAE,KAAI,CAAC,UAAU,EAAE,CAAC,KAAK,CAAC,UAAC,CAAC,IAAO,OAAO,CAAC,KAAK,CAAC,iDAAiD,EAAE,CAAC,CAAC,CAAA,CAAC,CAAC,CAAC,CAAA;YACxH,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;YACxC,IAAM,QAAQ,GAAG;gBACf,KAAK,EAAE,KAAI,CAAC,cAAc,CAAC,KAAK;gBAChC,cAAc,EAAE,KAAI,CAAC,cAAc,CAAC,cAAc;gBAClD,eAAe,EAAE,KAAI,CAAC,cAAc,CAAC,eAAe;gBACpD,QAAQ,EAAE,KAAI,CAAC,cAAc,CAAC,QAAQ;gBACtC,QAAQ,EAAE,KAAI,CAAC,cAAc,CAAC,QAAQ;gBACtC,QAAQ,EAAE,KAAI,CAAC,cAAc,CAAC,QAAQ;aACvC,CAAA;YACD,OAAO,CAAC,GAAG,CAAC,4BAA4B,GAAG,KAAI,CAAC,UAAU,EAAE,CAAC,CAAA;YAC7D,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,KAAI,CAAC,UAAU,EAAE,EAAE,QAAQ,CAAC,CAAA;YACxD,KAAI,CAAC,MAAM,GAAG,MAAM,CAAA;YACpB,KAAI,CAAC,MAAM,CAAC,EAAE,CAAC,SAAS,EAAE;gBACxB,KAAI,CAAC,gBAAgB,CAAC,SAAS,GAAG,IAAI,CAAA;gBACtC,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;gBACxC,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE,UAAC,GAAG;oBACrB,OAAO,CAAC,KAAK,CAAC,YAAY,EAAE,GAAG,CAAC,CAAA;oBAChC,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;gBAC1C,CAAC,CAAC,CAAA;gBACF,MAAM,CAAC,EAAE,CAAC,YAAY,EAAE;oBACtB,OAAO,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAA;oBAChC,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;gBAC1C,CAAC,CAAC,CAAA;gBACF,MAAM,CAAC,EAAE,CAAC,SAAS,EAAE,UAAC,KAAU;oBAC9B,KAAI,CAAC,gBAAgB,CAAC,SAAS,GAAG,KAAK,CAAA;oBACvC,KAAI,CAAC,uBAAuB,CAAC,UAAU,GAAG,KAAK,CAAA;oBAC/C,OAAO,CAAC,KAAK,CAAC,cAAc,EAAE,KAAK,CAAC,CAAA;oBACpC,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;gBAC1C,CAAC,CAAC,CAAA;gBACF,MAAM,CAAC,EAAE,CAAC,YAAY,EAAE,UAAC,KAAU;oBACjC,OAAO,CAAC,KAAK,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAA;oBACvC,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;gBAC1C,CAAC,CAAC,CAAA;gBACF,MAAM,CAAC,EAAE,CAAC,KAAK,EAAE,UAAC,KAAU;oBAC1B,KAAI,CAAC,gBAAgB,CAAC,SAAS,GAAG,KAAK,CAAA;oBACvC,KAAI,CAAC,uBAAuB,CAAC,UAAU,GAAG,KAAK,CAAA;oBAC/C,OAAO,CAAC,KAAK,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAA;oBACjD,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;gBAC1C,CAAC,CAAC,CAAA;gBACF,MAAM,CAAC,EAAE,CAAC,SAAS,EAAE,UAAC,KAAa,EAAE,OAAY,EAAE,MAAW;oBAC5D,IAAI,OAAO,GAAG,KAAK,CAAA;oBACnB,IAAI;wBACF,OAAO,GAAG,MAAM,CAAC,MAAM,CAAA;qBACxB;oBAAC,OAAO,KAAK,EAAE;wBAAE,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;qBAAE;oBACxC,IAAI,IAAI,GAAG,CAAQ,CAAA;oBACnB,IAAI;wBACF,IAAI,GAAG,MAAM,CAAC,GAAG,CAAA;qBAClB;oBAAC,OAAO,KAAK,EAAE;wBAAE,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;qBAAE;oBACxC,KAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAA,UAAU,IAAI,OAAA,UAAU,CAAC,SAAS,CAAC;wBACzD,KAAK,EAAE,KAAK;wBACZ,OAAO,EAAE,OAAO,CAAC,QAAQ,EAAE;wBAC3B,MAAM,EAAE,OAAO;wBACf,GAAG,EAAE,IAAI;qBACV,CAAC,EALoC,CAKpC,CAAC,CAAA;gBACL,CAAC,CAAC,CAAA;gBACF,OAAO,EAAE,CAAA;YACX,CAAC,CAAC,CAAA;YACF,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE;gBACjB,OAAO,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAA;gBACvC,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;gBACxC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAA;YACxB,CAAC,CAAC,CAAA;QACJ,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,8DAA8D;IACvD,iCAAU,GAAjB;QAAA,iBAaC;QAZC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YACjC,IAAI,CAAC,KAAI,CAAC,MAAM;gBAAE,OAAO,MAAM,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAA;YAC3D,KAAI,CAAC,gBAAgB,CAAC,cAAc,GAAG,CAAC,CAAA;YACxC,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,EAAE,UAAC,GAAG;gBAC5B,IAAI,GAAG,EAAE;oBACP,sDAAsD;oBACtD,OAAO,MAAM,CAAC,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC,CAAA;iBACjD;gBACD,uDAAuD;gBACvD,OAAO,EAAE,CAAA;YACX,CAAC,CAAC,CAAA;QACJ,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,8DAA8D;IACvD,gCAAS,GAAhB,UAAkB,KAAa,EAAE,GAAQ;QACvC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAA;QACrB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAA;QACjB,OAAO,IAAI,CAAC,UAAU,EAAE,CAAA;IAC1B,CAAC;IAED,8DAA8D;IACtD,iCAAU,GAAlB;QAAA,iBAmBC;QAlBC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YACjC,IAAI,CAAC,KAAI,CAAC,MAAM,EAAE;gBAChB,uGAAuG;gBACvG,OAAO,MAAM,CAAC,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC,CAAA;aACrD;YACD,KAAI,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,UAAC,CAAC,IAAO,OAAO,CAAC,KAAK,CAAC,+BAA+B,EAAE,CAAC,CAAC,CAAA,CAAC,CAAC,CAAC,CAAA;YACtF,KAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,KAAI,CAAC,MAAM,EAAE,EAAE,UAAC,GAAG;gBAC7D,IAAI,GAAG,EAAE;oBACP,kEAAkE;oBAClE,OAAO,MAAM,CAAC,IAAI,KAAK,CAAC,4BAA4B,GAAG,KAAI,CAAC,QAAQ,CAAC,CAAC,CAAA;iBACvE;gBACD,KAAI,CAAC,uBAAuB,CAAC,UAAU,GAAG,IAAI,CAAA;gBAC9C,KAAI,CAAC,uBAAuB,CAAC,KAAK,GAAG,KAAI,CAAC,QAAQ,CAAA;gBAClD,KAAI,CAAC,uBAAuB,CAAC,GAAG,GAAG,KAAI,CAAC,MAAM,CAAA;gBAC9C,wFAAwF;gBACxF,OAAO,EAAE,CAAA;YACX,CAAC,CAAC,CAAA;QACJ,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,8DAA8D;IACvD,kCAAW,GAAlB;QAAA,iBAmBC;QAlBC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YACjC,IAAM,aAAa,GAAG,KAAI,CAAC,uBAAuB,CAAC,UAAU,CAAA;YAC7D,KAAI,CAAC,uBAAuB,CAAC,UAAU,GAAG,KAAK,CAAA;YAC/C,IAAI,CAAC,KAAI,CAAC,MAAM,EAAE;gBAChB,wGAAwG;gBACxG,OAAO,MAAM,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAA;aAC1C;YACD,IAAI,aAAa,EAAE;gBACjB,KAAI,CAAC,MAAM,CAAC,WAAW,CAAC,KAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,EAAE,EAAE,UAAC,GAAG;oBAClE,IAAI,GAAG,EAAE;wBACP,wFAAwF;wBACxF,OAAO,MAAM,CAAC,IAAI,KAAK,CAAC,8BAA8B,GAAG,KAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC,CAAA;qBAC9F;oBACD,yFAAyF;oBACzF,OAAO,EAAE,CAAA;gBACX,CAAC,CAAC,CAAA;aACH;QACH,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,8DAA8D;IACvD,8BAAO,GAAd,UAAgB,KAAa,EAAE,OAAe,EAAE,MAAe,EAAE,GAAQ;QAAzE,iBAQC;QAPC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YACjC,IAAI,CAAC,KAAI,CAAC,MAAM;gBAAE,OAAO,MAAM,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAA;YAC3D,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,UAAC,GAAG;gBACpE,IAAI,GAAG;oBAAE,OAAO,MAAM,CAAC,IAAI,KAAK,CAAC,0BAA0B,GAAG,KAAK,CAAC,CAAC,CAAA;gBACrE,OAAO,EAAE,CAAA;YACX,CAAC,CAAC,CAAA;QACJ,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,8DAA8D;IACvD,qCAAc,GAArB;QACE,QAAQ,IAAI,CAAC,SAAS,CAAC,cAAc,EAAE;YACrC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,eAAe,CAAA;YAC/B,KAAK,CAAC,CAAC,CAAC,OAAO,cAAc,CAAA;YAC7B,KAAK,CAAC,CAAC,CAAC,OAAO,WAAW,CAAA;YAC1B,KAAK,CAAC,CAAC,CAAC,OAAO,gBAAgB,GAAG,IAAI,CAAC,UAAU,EAAE,CAAA;YACnD,KAAK,CAAC,CAAC,CAAC,OAAO,SAAS,CAAA;YACxB,KAAK,CAAC,CAAC,CAAC,OAAO,YAAY,CAAA;YAC3B,KAAK,CAAC,CAAC,CAAC,OAAO,SAAS,CAAA;YACxB,KAAK,CAAC,CAAC,CAAC,OAAO,eAAe,CAAA;YAC9B,OAAO,CAAC,CAAC,MAAK;SACf;QACD,OAAO,WAAW,CAAA;IACpB,CAAC;IAED,8DAA8D;IACjD,oCAAa,GAA1B,UAA4B,IAAY,EAAE,cAAsB;uCAAG,OAAO;;;;;wBACxE,IAAI,CAAC,qBAAqB,CAAC,IAAI,GAAG,IAAI,CAAA;wBACtC,IAAI,CAAC,uBAAuB,CAAC,KAAK,GAAG,cAAc,CAAA;;;;wBAEjD,qBAAM,IAAI,CAAC,QAAQ,EAAE,EAAA;;wBAArB,SAAqB,CAAA;wBACrB,qBAAM,IAAI,CAAC,UAAU,EAAE,EAAA;;wBAAvB,SAAuB,CAAA;;;;wBAEvB,OAAO,CAAC,KAAK,CAAC,oCAAoC,GAAG,KAAG,CAAC,CAAA;wBACzD,sBAAO,KAAK,EAAA;4BAEd,sBAAO,IAAI,EAAA;;;;KACZ;IAED,8DAA8D;IACvD,yCAAkB,GAAzB,UAA2B,UAA4B;QACrD,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;QAChC,UAAU,CAAC,cAAc,CAAC,IAAI,CAAC,CAAA;IACjC,CAAC;IAED,8DAA8D;IACjD,sCAAe,GAA5B;uCAAiC,OAAO;;;;;;wBAEpC,qBAAM,IAAI,CAAC,QAAQ,EAAE,EAAA;;wBAArB,SAAqB,CAAA;wBACrB,qBAAM,IAAI,CAAC,UAAU,EAAE,EAAA;;wBAAvB,SAAuB,CAAA;;;;wBAEvB,OAAO,CAAC,KAAK,CAAC,sCAAsC,GAAG,KAAG,CAAC,CAAA;wBAC3D,sBAAO,KAAK,EAAA;4BAEd,sBAAO,IAAI,EAAA;;;;KACZ;IAED,8DAA8D;IACvD,2BAAI,GAAX;QACE,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAA;IAClC,CAAC;IACH,mBAAC;AAAD,CAAC,AA/QD,IA+QC","sourcesContent":["// ______CiMqttClient.ts_________________________khartinger_____\r\n// 2021-12-26: new\r\nimport mqtt, { QoS } from 'mqtt'\r\nimport { CiBaseController } from '@/controller/CiBaseController'\r\nimport { reactive, readonly } from 'vue'\r\n\r\n// *************************************************************\r\n// interfaces\r\n// *************************************************************\r\n\r\n// -----------message properties--------------------------------\r\nexport interface Message {\r\n  topic: string,\r\n  payload: string,\r\n  retain: boolean,\r\n  qos: QoS\r\n}\r\n\r\n// -----------state of the MQTT connection----------------------\r\nexport interface MqttState {\r\n  connectOnStart: boolean;\r\n  connected: boolean;\r\n  iConnMqttState: number;\r\n  message: Message;\r\n}\r\n\r\n// -----------properties for the MQTT connection----------------\r\nexport interface MqttConnection {\r\n  host: string;\r\n  port: number;\r\n  endpoint: string;\r\n  clean: boolean;\r\n  connectTimeout: number;\r\n  reconnectPeriod: number;\r\n  clientId: string;\r\n  username: string;\r\n  password: string;\r\n}\r\n\r\n// -----------info about the subscribed messages----------------\r\nexport interface MqttSubscription {\r\n  topic: string;\r\n  qos: QoS;\r\n  subscribed: boolean;\r\n}\r\n\r\n// *************************************************************\r\n// class CiMqttClient\r\n// *************************************************************\r\n\r\nexport class CiMqttClient {\r\n  // ---------basic properties----------------------------------\r\n  public client: mqtt.Client | null = null;\r\n  public controller: Array<CiBaseController> = [];\r\n\r\n  private subTopic = '#';\r\n  private subQos: QoS = 0;\r\n\r\n  // ---------some more properties (interfaces)-----------------\r\n  // To prevent values from being changed by mistake,\r\n  // there is always a private and a public variant.\r\n  private privateMqttState: MqttState = reactive<MqttState>({\r\n    connectOnStart: false,\r\n    connected: false,\r\n    iConnMqttState: -1,\r\n    message: { topic: '', payload: '', retain: false, qos: 0 }\r\n  })\r\n\r\n  public mqttState = readonly(this.privateMqttState)\r\n\r\n  private privateMqttConnection: MqttConnection = reactive<MqttConnection>({\r\n    host: '192.168.0.7',\r\n    port: 1884,\r\n    endpoint: '',\r\n    clean: true,\r\n    connectTimeout: 4000,\r\n    reconnectPeriod: 4000,\r\n    clientId: '',\r\n    username: '',\r\n    password: ''\r\n  })\r\n\r\n  public mqttConnection = readonly(this.privateMqttConnection)\r\n\r\n  private privateMqttSubscription: MqttSubscription = reactive<MqttSubscription>({\r\n    topic: '#',\r\n    qos: 0,\r\n    subscribed: false\r\n  })\r\n\r\n  public mqttSubscription = readonly(this.privateMqttSubscription)\r\n\r\n  // =========methods===========================================\r\n  // _________constructor_______________________________________\r\n  constructor (connectOnStart: boolean) {\r\n    this.privateMqttState.connectOnStart = connectOnStart\r\n    console.log('MqttClient-Constructor: privateMqttState.connectOnStart = ', this.privateMqttState.connectOnStart)\r\n    if (this.privateMqttState.connectOnStart) {\r\n      console.log('MqttClient-Constructor: connecting to ' + this.connectUrl())\r\n      this.connect_().then(() => {\r\n        this.subTopic = this.privateMqttSubscription.topic\r\n        this.subQos = this.privateMqttSubscription.qos\r\n        console.log('MqttClient-Constructor: subscribe ' + this.privateMqttSubscription.topic)\r\n        this.subscribe_().catch((e) => { console.error('MqttClient-constructor: Subcribe ERROR:', e) })\r\n      }).catch((e) => { console.error('MqttClient-constructor: Connect ERROR:', e) })\r\n      console.log('MqttClient-constructor: finished')\r\n    }\r\n  }\r\n\r\n  // _________connect url like 10.1.1.1:1884____________________\r\n  public connectUrl (): string {\r\n    return `ws://${this.mqttConnection.host}:${this.mqttConnection.port}${this.mqttConnection.endpoint}`\r\n  }\r\n\r\n  // _________public variant: connect to server (broker)________\r\n  public connect (host: string, port: number, endpoint: string): Promise<void> {\r\n    this.privateMqttConnection.host = host\r\n    this.privateMqttConnection.port = port\r\n    this.privateMqttConnection.endpoint = endpoint\r\n    return this.connect_()\r\n  }\r\n\r\n  // _________private variant: connect to server (broker)_______\r\n  private connect_ (): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (this.client) this.disconnect().catch((e) => { console.error('MqttClient-connect_: ERROR while disconnecting:', e) })\r\n      this.privateMqttState.iConnMqttState = 2\r\n      const options_ = {\r\n        clean: this.mqttConnection.clean,\r\n        connectTimeout: this.mqttConnection.connectTimeout,\r\n        reconnectPeriod: this.mqttConnection.reconnectPeriod,\r\n        clientId: this.mqttConnection.clientId,\r\n        username: this.mqttConnection.username,\r\n        password: this.mqttConnection.password\r\n      }\r\n      console.log('MqttCient.ts-connect: url=' + this.connectUrl())\r\n      const client = mqtt.connect(this.connectUrl(), options_)\r\n      this.client = client\r\n      this.client.on('connect', () => {\r\n        this.privateMqttState.connected = true\r\n        this.privateMqttState.iConnMqttState = 1\r\n        client.on('error', (err) => {\r\n          console.error('MQTT Error', err)\r\n          this.privateMqttState.iConnMqttState = 7\r\n        })\r\n        client.on('connecting', () => {\r\n          console.error('MQTT Connecting')\r\n          this.privateMqttState.iConnMqttState = 2\r\n        })\r\n        client.on('offline', (value: any) => {\r\n          this.privateMqttState.connected = false\r\n          this.privateMqttSubscription.subscribed = false\r\n          console.error('MQTT Offline', value)\r\n          this.privateMqttState.iConnMqttState = 3\r\n        })\r\n        client.on('disconnect', (value: any) => {\r\n          console.error('MQTT Disconnect', value)\r\n          this.privateMqttState.iConnMqttState = 0\r\n        })\r\n        client.on('end', (value: any) => {\r\n          this.privateMqttState.connected = false\r\n          this.privateMqttSubscription.subscribed = false\r\n          console.error('MqttClient.ts-end: value=', value)\r\n          this.privateMqttState.iConnMqttState = 9\r\n        })\r\n        client.on('message', (topic: string, payload: any, props1: any) => {\r\n          let retain1 = false\r\n          try {\r\n            retain1 = props1.retain\r\n          } catch (error) { console.error(error) }\r\n          let qos1 = 0 as QoS\r\n          try {\r\n            qos1 = props1.qos\r\n          } catch (error) { console.error(error) }\r\n          this.controller.forEach(controller => controller.onMessage({\r\n            topic: topic,\r\n            payload: payload.toString(),\r\n            retain: retain1,\r\n            qos: qos1\r\n          }))\r\n        })\r\n        resolve()\r\n      })\r\n      client.on('error', () => {\r\n        console.error('Error on connecting...')\r\n        this.privateMqttState.iConnMqttState = 8\r\n        reject(Error('Error'))\r\n      })\r\n    })\r\n  }\r\n\r\n  // _________disconnect from broker____________________________\r\n  public disconnect (): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.client) return reject(new Error('Not Connected'))\r\n      this.privateMqttState.iConnMqttState = 9\r\n      this.client.end(true, {}, (err) => {\r\n        if (err) {\r\n          // console.log('CiMqttClient:disconnect: ', 'failed!')\r\n          return reject(new Error('Could not disconnect'))\r\n        }\r\n        // console.log('CiMqttClient:disconnect: ', 'success!')\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  // _________public variant: subscribe topic___________________\r\n  public subscribe (topic: string, qos: QoS): Promise<void> {\r\n    this.subTopic = topic\r\n    this.subQos = qos\r\n    return this.subscribe_()\r\n  }\r\n\r\n  // _________private variant: subscribe topic__________________\r\n  private subscribe_ (): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.client) {\r\n        // console.log('CiMqttClient:subscribe: failed - not connected! ' + this.privateMqttSubscription.topic)\r\n        return reject(new Error('subscribe: Not Connected'))\r\n      }\r\n      this.unsubscribe().catch((e) => { console.error('MqttClient-subscribe_: ERROR:', e) })\r\n      this.client.subscribe(this.subTopic, { qos: this.subQos }, (err) => {\r\n        if (err) {\r\n          // console.log('CiMqttClient:subscribe: failed! ' + this.subTopic)\r\n          return reject(new Error('Could not subscribe topic ' + this.subTopic))\r\n        }\r\n        this.privateMqttSubscription.subscribed = true\r\n        this.privateMqttSubscription.topic = this.subTopic\r\n        this.privateMqttSubscription.qos = this.subQos\r\n        // console.log('CiMqttClient:subscribe: success! ' + this.privateMqttSubscription.topic)\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  // _________unsubscribe topic_________________________________\r\n  public unsubscribe (): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      const subscribedOld = this.privateMqttSubscription.subscribed\r\n      this.privateMqttSubscription.subscribed = false\r\n      if (!this.client) {\r\n        // console.log('CiMqttClient:unsubscribe: failed - not connected! ', this.privateMqttSubscription.topic)\r\n        return reject(new Error('Not Connected'))\r\n      }\r\n      if (subscribedOld) {\r\n        this.client.unsubscribe(this.privateMqttSubscription.topic, {}, (err) => {\r\n          if (err) {\r\n            // console.log('CiMqttClient:unsubscribe: failed! ', this.privateMqttSubscription.topic)\r\n            return reject(new Error('Could not unsubscribe topic ' + this.privateMqttSubscription.topic))\r\n          }\r\n          // console.log('CiMqttClient:unsubscribe: success! ', this.privateMqttSubscription.topic)\r\n          resolve()\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  // _________publish a message_________________________________\r\n  public publish (topic: string, payload: string, retain: boolean, qos: QoS): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.client) return reject(new Error('Not Connected'))\r\n      this.client.publish(topic, payload, { qos: qos, retain: retain }, (err) => {\r\n        if (err) return reject(new Error('Could not publish topic ' + topic))\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  // _________return mqtt connection state as string____________\r\n  public sConnMqttState (): string {\r\n    switch (this.mqttState.iConnMqttState) {\r\n      case -1: return 'not connected'\r\n      case 0: return 'disconnected'\r\n      case 1: return 'connected'\r\n      case 2: return 'connecting to ' + this.connectUrl()\r\n      case 3: return 'offline'\r\n      case 7: return 'mqtt error'\r\n      case 8: return 'timeout'\r\n      case 9: return 'end connected'\r\n      default: break\r\n    }\r\n    return 'undefined'\r\n  }\r\n\r\n  // _________connect to a broker and subscribe a topic_________\r\n  public async hostSubscribe (host: string, topicSubscribe: string): Promise<boolean> {\r\n    this.privateMqttConnection.host = host\r\n    this.privateMqttSubscription.topic = topicSubscribe\r\n    try {\r\n      await this.connect_()\r\n      await this.subscribe_()\r\n    } catch (err) {\r\n      console.error('CiMqttClient.hostSubscribe: Error ' + err)\r\n      return false\r\n    }\r\n    return true\r\n  }\r\n\r\n  // _________method to register controller_____________________\r\n  public registerController (controller: CiBaseController): void {\r\n    this.controller.push(controller)\r\n    controller.registerClient(this)\r\n  }\r\n\r\n  // _________reconnect to broker with default values___________\r\n  public async reconnectBroker (): Promise<boolean> {\r\n    try {\r\n      await this.connect_()\r\n      await this.subscribe_()\r\n    } catch (err) {\r\n      console.error('CiMqttClient.reconnectBroker: Error ' + err)\r\n      return false\r\n    }\r\n    return true\r\n  }\r\n\r\n  // _________nothing to do...__________________________________\r\n  public init (): void {\r\n    console.log('CiMqttClient.init')\r\n  }\r\n}\r\n"]}]}