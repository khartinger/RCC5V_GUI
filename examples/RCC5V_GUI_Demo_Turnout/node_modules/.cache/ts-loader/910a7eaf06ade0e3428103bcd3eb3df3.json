{"remainingRequest":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js??ref--13-1!G:\\work3\\vue\\haus3\\src\\controller\\CiButton1Controller.ts","dependencies":[{"path":"G:\\work3\\vue\\haus3\\src\\controller\\CiButton1Controller.ts","mtime":1676312984889},{"path":"G:\\work3\\vue\\haus3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSAidHNsaWIiOw0KLy8gX19fX19fQ2lCdXR0b24xQ29udHJvbGxlci50c19fX19fX19fX19fX19fX19fX2toYXJ0aW5nZXJfX19fXw0KLy8gMjAyMi0wOS0xNDogYWRkIC5jYXRjaCgoZSkgLi4pIHRvIHRoaXMucHVibGlzaA0KLy8gMjAyMy0wMS0yNTogYWRkIHRleHRDZW50ZXIsIHRleHRGb290ZXIgfCByZW1vdmUgc2hhcGUsIGNvbG9yDQppbXBvcnQgeyByZWFjdGl2ZSB9IGZyb20gJ3Z1ZSc7DQppbXBvcnQgeyBDaUJhc2VDb250cm9sbGVyIH0gZnJvbSAnLi9DaUJhc2VDb250cm9sbGVyJzsNCnZhciBDaUJ1dHRvbjFDb250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgew0KICAgIF9fZXh0ZW5kcyhDaUJ1dHRvbjFDb250cm9sbGVyLCBfc3VwZXIpOw0KICAgIGZ1bmN0aW9uIENpQnV0dG9uMUNvbnRyb2xsZXIoKSB7DQogICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOw0KICAgICAgICBfdGhpcy5idXR0b25zMSA9IHJlYWN0aXZlKFsNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ2FyMV9ibDEnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdMYW1wZTMnLA0KICAgICAgICAgICAgICAgIGlCdXR0b25TdGF0ZTogLTk5LA0KICAgICAgICAgICAgICAgIGJhdHRlcnk6ICctJywNCiAgICAgICAgICAgICAgICBzdWJUb3BpYzogJ2UxL2FyL3Rhc3Rlci8zL3JldC92b2x0YWdlJywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzogJ2UxL2FyL2xpY2h0LzMvc2V0L2xpY2h0JywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAnLTEnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlkOiAnc2wzX2JsMScsDQogICAgICAgICAgICAgICAgbmFtZTogJ0xhbXBlMScsDQogICAgICAgICAgICAgICAgaUJ1dHRvblN0YXRlOiAtOTksDQogICAgICAgICAgICAgICAgYmF0dGVyeTogJy0nLA0KICAgICAgICAgICAgICAgIHN1YlRvcGljOiAnbzIvc2wvdGFzdGVyLzEvcmV0L3ZvbHRhZ2UnLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnbzIvc2wvbGljaHQvMS9zZXQvbGljaHQnLA0KICAgICAgICAgICAgICAgIHB1YlBheWxvYWQ6ICctMScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWQ6ICd2cjFfcm9fdXAnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdST0xMTyBeJywNCiAgICAgICAgICAgICAgICBpQnV0dG9uU3RhdGU6IC05OSwNCiAgICAgICAgICAgICAgICB0ZXh0Q2VudGVyOiAnQVVGJywNCiAgICAgICAgICAgICAgICBzdWJUb3BpYzogJ2UxL3ZvL3JvbGxvL3JldC9tb3RvcicsDQogICAgICAgICAgICAgICAgcHViVG9waWM6ICdlMS92by9yb2xsby9zZXQvbW90b3InLA0KICAgICAgICAgICAgICAgIHB1YlBheWxvYWQ6ICcxJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ3ZyMV9yb19kbicsDQogICAgICAgICAgICAgICAgbmFtZTogJ1JPTExPIFYnLA0KICAgICAgICAgICAgICAgIGlCdXR0b25TdGF0ZTogLTk5LA0KICAgICAgICAgICAgICAgIHRleHRDZW50ZXI6ICdBQicsDQogICAgICAgICAgICAgICAgc3ViVG9waWM6ICdlMS92by9yb2xsby9yZXQvbW90b3InLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnZTEvdm8vcm9sbG8vc2V0L21vdG9yJywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkOiAnLTEnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlkOiAnaHUyX2ltZ3N0cm9tJywNCiAgICAgICAgICAgICAgICBuYW1lOiAnT0snLA0KICAgICAgICAgICAgICAgIGlCdXR0b25TdGF0ZTogLTk5LA0KICAgICAgICAgICAgICAgIGJhdHRlcnk6ICctJywNCiAgICAgICAgICAgICAgICB0ZXh0Q2VudGVyOiAnQWt0dWFsaXNpZXJlbicsDQogICAgICAgICAgICAgICAgc3ViVG9waWM6ICdpcC9oL2h1Mi9zdHJvbS9yZXQvcGhvdG9zJywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzogJ2lwL2gvaHUyL3N0cm9tL2dldCcsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZDogJ3Bob3RvcycNCiAgICAgICAgICAgIH0NCiAgICAgICAgXSk7DQogICAgICAgIHJldHVybiBfdGhpczsNCiAgICB9DQogICAgQ2lCdXR0b24xQ29udHJvbGxlci5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHsNCiAgICAgICAgdGhpcy5idXR0b25zMS5mb3JFYWNoKGZ1bmN0aW9uIChidXR0b24xKSB7DQogICAgICAgICAgICB2YXIgYVN1YlRvcGljID0gYnV0dG9uMS5zdWJUb3BpYy5zcGxpdCgnICcpOw0KICAgICAgICAgICAgaWYgKGFTdWJUb3BpYy5pbmNsdWRlcyhtZXNzYWdlLnRvcGljKSkgew0KICAgICAgICAgICAgICAgIC8vIC0tLWJ1dHRvbiBmb3VuZCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2lCdXR0b25Db250cm9sbGVyLm9uTWVzc2FnZSBwYXlsb2FkPScsIG1lc3NhZ2UucGF5bG9hZCkNCiAgICAgICAgICAgICAgICBpZiAoYnV0dG9uMS5pZC5zdWJzdHJpbmcoMCwgNykgPT09ICd2cjFfcm9fJykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYVBheWxvYWQgPSBKU09OLnBhcnNlKG1lc3NhZ2UucGF5bG9hZCk7DQogICAgICAgICAgICAgICAgICAgIGJ1dHRvbjEuaUJ1dHRvblN0YXRlID0gMTAgKyBhUGF5bG9hZC5tb3RvcjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnRvcGljLmluY2x1ZGVzKCd2b2x0YWdlJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbjEuYmF0dGVyeSA9ICIiICsgbWVzc2FnZS5wYXlsb2FkICsgJyUnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIC0tLXVwZGF0ZSBjdXJyZW50IGNvdW50ZXItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgICAgICAgICAgaWYgKGJ1dHRvbjEuaWQuc3Vic3RyaW5nKDAsIDEyKSA9PT0gJ2h1Ml9pbWdzdHJvbScpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZS5wYXlsb2FkKTsNCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uMS5uYW1lID0gbWVzc2FnZS5wYXlsb2FkOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvLyAtLS1FTkQgYnV0dG9uIGZvdW5kIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH07DQogICAgQ2lCdXR0b24xQ29udHJvbGxlci5wcm90b3R5cGUucHVibGlzaENpID0gZnVuY3Rpb24gKHRvcGljLCBwYXlsb2FkKSB7DQogICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaUJ1dHRvbjFDb250cm9sbGVyOnB1Ymxpc2hDaTonLCAnLXQgJyArIHRvcGljICsgJyAtbSAnICsgcGF5bG9hZCkNCiAgICAgICAgdGhpcy5wdWJsaXNoKHRvcGljLCBwYXlsb2FkLCBmYWxzZSwgMCkuY2F0Y2goZnVuY3Rpb24gKGUpIHsgY29uc29sZS5lcnJvcignQ2lCdXR0b25Db250cm9sbGVyOiBFUlJPUjonLCBlKTsgfSk7DQogICAgfTsNCiAgICByZXR1cm4gQ2lCdXR0b24xQ29udHJvbGxlcjsNCn0oQ2lCYXNlQ29udHJvbGxlcikpOw0KZXhwb3J0IHsgQ2lCdXR0b24xQ29udHJvbGxlciB9Ow0KZXhwb3J0IHZhciBjaUJ1dHRvbjFDb250cm9sbGVyID0gbmV3IENpQnV0dG9uMUNvbnRyb2xsZXIoKTsNCg=="},{"version":3,"file":"G:\\work3\\vue\\haus3\\src\\controller\\CiButton1Controller.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus3\\src\\controller\\CiButton1Controller.ts"],"names":[],"mappings":"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","sourcesContent":["// ______CiButton1Controller.ts__________________khartinger_____\r\n// 2022-09-14: add .catch((e) ..) to this.publish\r\n// 2023-01-25: add textCenter, textFooter | remove shape, color\r\nimport { reactive } from 'vue'\r\nimport { Message } from '@/services/CiMqttClient'\r\nimport { CiBaseController, IBase } from './CiBaseController'\r\n\r\nexport interface Button1 extends IBase {\r\n  iButtonState: number;\r\n  battery?: string;\r\n  textCenter?: string;\r\n  textFooter?: string;\r\n}\r\n\r\nexport class CiButton1Controller extends CiBaseController {\r\n  public buttons1: Array<Button1> = reactive(\r\n    [\r\n      { // ---Lichtschalter Arbeitszimmer-----------------------\r\n        id: 'ar1_bl1',\r\n        name: 'Lampe3',\r\n        iButtonState: -99,\r\n        battery: '-',\r\n        subTopic: 'e1/ar/taster/3/ret/voltage',\r\n        pubTopic: 'e1/ar/licht/3/set/licht',\r\n        pubPayload: '-1'\r\n      },\r\n      { // ---Lichtschalter Schlafzimmer------------------------\r\n        id: 'sl3_bl1',\r\n        name: 'Lampe1',\r\n        iButtonState: -99,\r\n        battery: '-',\r\n        subTopic: 'o2/sl/taster/1/ret/voltage',\r\n        pubTopic: 'o2/sl/licht/1/set/licht',\r\n        pubPayload: '-1'\r\n      },\r\n      { // ---Erdgeschoss: Vorraum, Rollo auf-------------------\r\n        id: 'vr1_ro_up',\r\n        name: 'ROLLO ^',\r\n        iButtonState: -99,\r\n        textCenter: 'AUF',\r\n        subTopic: 'e1/vo/rollo/ret/motor',\r\n        pubTopic: 'e1/vo/rollo/set/motor',\r\n        pubPayload: '1'\r\n      },\r\n      { // ---Erdgeschoss: Vorraum, Rollo ab--------------------\r\n        id: 'vr1_ro_dn',\r\n        name: 'ROLLO V',\r\n        iButtonState: -99,\r\n        textCenter: 'AB',\r\n        subTopic: 'e1/vo/rollo/ret/motor',\r\n        pubTopic: 'e1/vo/rollo/set/motor',\r\n        pubPayload: '-1'\r\n      },\r\n      { // ---Aktualisieren Stromzaehler-Bilder-----------------\r\n        id: 'hu2_imgstrom',\r\n        name: 'OK',\r\n        iButtonState: -99,\r\n        battery: '-',\r\n        textCenter: 'Aktualisieren',\r\n        subTopic: 'ip/h/hu2/strom/ret/photos',\r\n        pubTopic: 'ip/h/hu2/strom/get',\r\n        pubPayload: 'photos'\r\n      }\r\n    ]\r\n  );\r\n\r\n  public onMessage (message: Message): void {\r\n    this.buttons1.forEach(button1 => {\r\n      const aSubTopic = button1.subTopic.split(' ')\r\n      if (aSubTopic.includes(message.topic)) {\r\n        // ---button found ---------------------------------\r\n        // console.log('CiButtonController.onMessage payload=', message.payload)\r\n        if (button1.id.substring(0, 7) === 'vr1_ro_') {\r\n          const aPayload = JSON.parse(message.payload)\r\n          button1.iButtonState = 10 + aPayload.motor\r\n        } else {\r\n          if (message.topic.includes('voltage')) {\r\n            button1.battery = `${message.payload}` + '%'\r\n          }\r\n        }\r\n        // ---update current counter----------------------------\r\n        if (button1.id.substring(0, 12) === 'hu2_imgstrom') {\r\n          console.log(message.payload)\r\n          button1.name = message.payload\r\n        }\r\n        // ---END button found -----------------------------\r\n      }\r\n    })\r\n  }\r\n\r\n  public publishCi (topic: string, payload: string): void {\r\n    // console.log('CiButton1Controller:publishCi:', '-t ' + topic + ' -m ' + payload)\r\n    this.publish(topic, payload, false, 0).catch((e) => { console.error('CiButtonController: ERROR:', e) })\r\n  }\r\n}\r\n\r\nexport const ciButton1Controller = new CiButton1Controller()\r\n"]}]}