{"remainingRequest":"G:\\work3\\vue\\haus3\\node_modules\\thread-loader\\dist\\cjs.js!G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js??ref--13-2!G:\\work3\\vue\\haus3\\src\\controller\\CiSocket2Controller.ts","dependencies":[{"path":"G:\\work3\\vue\\haus3\\src\\controller\\CiSocket2Controller.ts","mtime":1676313782495},{"path":"G:\\work3\\vue\\haus3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSAidHNsaWIiOw0KLy8gX19fX19fQ2lTb2NrZXQyQ29udHJvbGxlci50c19fX19fX19fX19fX19fX19fX2toYXJ0aW5nZXJfX19fXw0KLy8gMjAyMi0wOC0wNzogbmV3DQovLyAyMDIzLTAxLTI5OiBjaGFuZ2UgYXQgQ2lCYXNlIChhZGQgR2VvLnRzKQ0KaW1wb3J0IHsgcmVhY3RpdmUgfSBmcm9tICd2dWUnOw0KaW1wb3J0IHsgQ2lCYXNlQ29udHJvbGxlciB9IGZyb20gJy4vQ2lCYXNlQ29udHJvbGxlcic7DQp2YXIgQ2lTb2NrZXQyQ29udHJvbGxlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsNCiAgICBfX2V4dGVuZHMoQ2lTb2NrZXQyQ29udHJvbGxlciwgX3N1cGVyKTsNCiAgICBmdW5jdGlvbiBDaVNvY2tldDJDb250cm9sbGVyKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsNCiAgICAgICAgX3RoaXMuc29ja2V0czIgPSByZWFjdGl2ZShbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdHlwZTogJ2RlbG9jazExODI2JywNCiAgICAgICAgICAgICAgICBpZDogJ3MxLTMxMTMnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdzMScsDQogICAgICAgICAgICAgICAgaVNvY2tldDJTdGF0ZTogLTk5LA0KICAgICAgICAgICAgICAgIHRleHRVcHBlcjogJ09OJywNCiAgICAgICAgICAgICAgICB0ZXh0TG93ZXI6ICdPRkYnLA0KICAgICAgICAgICAgICAgIC8vIHRleHRGb290ZXI6ICdzb2NrZXRfczEnLA0KICAgICAgICAgICAgICAgIHN1YlRvcGljOiAnaXAvaC9zdGVja2Rvc2UvczEvUkVTVUxUJywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzogJ2lwL2gvc3RlY2tkb3NlL3MxL2NtbmQvUE9XRVInLA0KICAgICAgICAgICAgICAgIHB1YlBheWxvYWQ6ICdPTicsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZExvd2VyOiAnT0ZGJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0eXBlOiAnZGVsb2NrMTE4MjYnLA0KICAgICAgICAgICAgICAgIGlkOiAnczItNDQ5NycsDQogICAgICAgICAgICAgICAgbmFtZTogJ3MyJywNCiAgICAgICAgICAgICAgICBpU29ja2V0MlN0YXRlOiAtOTksDQogICAgICAgICAgICAgICAgdGV4dFVwcGVyOiAnT04nLA0KICAgICAgICAgICAgICAgIHRleHRMb3dlcjogJ09GRicsDQogICAgICAgICAgICAgICAgLy8gdGV4dEZvb3RlcjogJ3NvY2tldF9zMicsDQogICAgICAgICAgICAgICAgc3ViVG9waWM6ICdpcC9oL3N0ZWNrZG9zZS9zMi9SRVNVTFQnLA0KICAgICAgICAgICAgICAgIHB1YlRvcGljOiAnaXAvaC9zdGVja2Rvc2UvczIvY21uZC9QT1dFUicsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZDogJ09OJywNCiAgICAgICAgICAgICAgICBwdWJQYXlsb2FkTG93ZXI6ICdPRkYnDQogICAgICAgICAgICB9DQogICAgICAgICAgICAvKg0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBpZDogJ3NvY2tldDEnLA0KICAgICAgICAgICAgICBuYW1lOiAnU29ja2V0Ml8xJywNCiAgICAgICAgICAgICAgaVNvY2tldDJTdGF0ZTogLTk5LA0KICAgICAgICAgICAgICB0eXBlOiAnZGVsb2NrMTE4MjYnLA0KICAgICAgICAgICAgICAvLyB0ZXh0VXBwZXI6ICdPTicsDQogICAgICAgICAgICAgIC8vIHRleHRMb3dlcjogJ09GRicsDQogICAgICAgICAgICAgIHRleHRGb290ZXI6ICctLUZvb3RlcjEtLScsDQogICAgICAgICAgICAgIHN1YlRvcGljOiAnY2kvc29ja2V0Mi8xL3JldCBjaS9zb2NrZXQyL3NldCcsDQogICAgICAgICAgICAgIHB1YlRvcGljOiAnY2kvc29ja2V0Mi8xL3NldC9zb2NrZXQyIGNpL3NvY2tldDIvc2V0JywNCiAgICAgICAgICAgICAgcHViUGF5bG9hZDogJ3siUE9XRVIiOiIxIn0nLA0KICAgICAgICAgICAgICBwdWJQYXlsb2FkTG93ZXI6ICd7IlBPV0VSIjoiMCJ9Jw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgaWQ6ICdzb2NrZXQyJywNCiAgICAgICAgICAgICAgbmFtZTogJ1NvY2tldDJfMicsDQogICAgICAgICAgICAgIGlTb2NrZXQyU3RhdGU6IC05OSwNCiAgICAgICAgICAgICAgdHlwZTogJ2RlbG9jazExODI2JywgLy8gZTE2MDM9SUtFQQ0KICAgICAgICAgICAgICB0ZXh0VXBwZXI6ICdPTicsDQogICAgICAgICAgICAgIHRleHRMb3dlcjogJ09GRicsDQogICAgICAgICAgICAgIHRleHRGb290ZXI6ICc9PUZvb3RlcjI9PScsDQogICAgICAgICAgICAgIHN1YlRvcGljOiAnY2kvc29ja2V0Mi8yL3JldCBjaS9zb2NrZXQyL3NldCcsDQogICAgICAgICAgICAgIHB1YlRvcGljOiAnY2kvc29ja2V0Mi8yL3NldC9zb2NrZXQyIGNpL3NvY2tldDIvc2V0JywNCiAgICAgICAgICAgICAgcHViUGF5bG9hZDogJ3siUE9XRVIiOiJPTiJ9JywNCiAgICAgICAgICAgICAgcHViUGF5bG9hZExvd2VyOiAneyJQT1dFUiI6Ik9GRiJ9Jw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgKi8NCiAgICAgICAgXSk7DQogICAgICAgIHJldHVybiBfdGhpczsNCiAgICB9DQogICAgQ2lTb2NrZXQyQ29udHJvbGxlci5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHsNCiAgICAgICAgdGhpcy5zb2NrZXRzMi5mb3JFYWNoKGZ1bmN0aW9uIChzb2NrZXQyKSB7DQogICAgICAgICAgICB2YXIgYVN1YlRvcGljID0gc29ja2V0Mi5zdWJUb3BpYy5zcGxpdCgnICcpOw0KICAgICAgICAgICAgaWYgKGFTdWJUb3BpYy5pbmNsdWRlcyhtZXNzYWdlLnRvcGljKSkgew0KICAgICAgICAgICAgICAgIC8vIC0tLXNvY2tldDIgZm91bmQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgICAgICAgICAgaWYgKHNvY2tldDIudHlwZSA9PT0gJ2RlbG9jazExODI2Jykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYVBheWxvYWQgPSBKU09OLnBhcnNlKG1lc3NhZ2UucGF5bG9hZCk7DQogICAgICAgICAgICAgICAgICAgIGlmICgoYVBheWxvYWQuUE9XRVIgPT09ICdPTicpIHx8IChhUGF5bG9hZC5QT1dFUiA9PT0gJzEnKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldDIuaVNvY2tldDJTdGF0ZSA9IC0xOw0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoYVBheWxvYWQuUE9XRVIgPT09ICdPRkYnKSB8fCAoYVBheWxvYWQuUE9XRVIgPT09ICcwJykpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ja2V0Mi5pU29ja2V0MlN0YXRlID0gLTI7DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXQyLmlTb2NrZXQyU3RhdGUgPSAtOTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvLyAtLS1lbmQgc29ja2V0MiBmb3VuZC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIENpU29ja2V0MkNvbnRyb2xsZXIucHJvdG90eXBlLnB1Ymxpc2hDaSA9IGZ1bmN0aW9uICh0b3BpYywgcGF5bG9hZCkgew0KICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2lTb2NrZXQxQ29udHJvbGxlcjpwdWJsaXNoQ2k6JywgJy10ICcgKyB0b3BpYyArICcgLW0gJyArIHBheWxvYWQpDQogICAgICAgIHRoaXMucHVibGlzaCh0b3BpYywgcGF5bG9hZCwgZmFsc2UsIDApLmNhdGNoKGZ1bmN0aW9uIChlKSB7IGNvbnNvbGUuZXJyb3IoJ0NpU29ja2V0Q29udHJvbGxlcjogRVJST1I6JywgZSk7IH0pOw0KICAgIH07DQogICAgcmV0dXJuIENpU29ja2V0MkNvbnRyb2xsZXI7DQp9KENpQmFzZUNvbnRyb2xsZXIpKTsNCmV4cG9ydCB7IENpU29ja2V0MkNvbnRyb2xsZXIgfTsNCmV4cG9ydCB2YXIgY2lTb2NrZXQyQ29udHJvbGxlciA9IG5ldyBDaVNvY2tldDJDb250cm9sbGVyKCk7DQo="},{"version":3,"file":"G:\\work3\\vue\\haus3\\src\\controller\\CiSocket2Controller.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus3\\src\\controller\\CiSocket2Controller.ts"],"names":[],"mappings":";AAAA,gEAAgE;AAChE,kBAAkB;AAClB,4CAA4C;AAC5C,OAAO,EAAE,QAAQ,EAAE,MAAM,KAAK,CAAA;AAE9B,OAAO,EAAE,gBAAgB,EAAS,MAAM,oBAAoB,CAAA;AAa5D;IAAyC,uCAAgB;IAAzD;QAAA,qEAmFC;QAlFQ,cAAQ,GAAmB,QAAQ,CACxC;YACE;gBACE,IAAI,EAAE,aAAa;gBACnB,EAAE,EAAE,SAAS;gBACb,IAAI,EAAE,IAAI;gBACV,aAAa,EAAE,CAAC,EAAE;gBAClB,SAAS,EAAE,IAAI;gBACf,SAAS,EAAE,KAAK;gBAChB,2BAA2B;gBAC3B,QAAQ,EAAE,0BAA0B;gBACpC,QAAQ,EAAE,8BAA8B;gBACxC,UAAU,EAAE,IAAI;gBAChB,eAAe,EAAE,KAAK;aACvB;YACD;gBACE,IAAI,EAAE,aAAa;gBACnB,EAAE,EAAE,SAAS;gBACb,IAAI,EAAE,IAAI;gBACV,aAAa,EAAE,CAAC,EAAE;gBAClB,SAAS,EAAE,IAAI;gBACf,SAAS,EAAE,KAAK;gBAChB,2BAA2B;gBAC3B,QAAQ,EAAE,0BAA0B;gBACpC,QAAQ,EAAE,8BAA8B;gBACxC,UAAU,EAAE,IAAI;gBAChB,eAAe,EAAE,KAAK;aACvB;YAED;;;;;;;;;;;;;;;;;;;;;;;;;;;cA2BE;SACH,CACF,CAAC;;IAwBJ,CAAC;IAtBQ,uCAAS,GAAhB,UAAkB,OAAgB;QAChC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,OAAO;YAC3B,IAAM,SAAS,GAAG,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;YAC7C,IAAI,SAAS,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBACrC,wDAAwD;gBACxD,IAAI,OAAO,CAAC,IAAI,KAAK,aAAa,EAAE;oBAClC,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;oBAC5C,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,GAAG,CAAC;wBAAE,OAAO,CAAC,aAAa,GAAG,CAAC,CAAC,CAAA;yBAChF;wBACH,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,GAAG,CAAC;4BAAE,OAAO,CAAC,aAAa,GAAG,CAAC,CAAC,CAAA;6BACjF;4BAAE,OAAO,CAAC,aAAa,GAAG,CAAC,CAAC,CAAA;yBAAE;qBACpC;iBACF;gBACD,wDAAwD;aACzD;QACH,CAAC,CAAC,CAAA;IACJ,CAAC;IAEM,uCAAS,GAAhB,UAAkB,KAAa,EAAE,OAAe;QAC9C,kFAAkF;QAClF,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,CAAC,IAAO,OAAO,CAAC,KAAK,CAAC,4BAA4B,EAAE,CAAC,CAAC,CAAA,CAAC,CAAC,CAAC,CAAA;IACzG,CAAC;IACH,0BAAC;AAAD,CAAC,AAnFD,CAAyC,gBAAgB,GAmFxD;;AAED,MAAM,CAAC,IAAM,mBAAmB,GAAG,IAAI,mBAAmB,EAAE,CAAA","sourcesContent":["// ______CiSocket2Controller.ts__________________khartinger_____\r\n// 2022-08-07: new\r\n// 2023-01-29: change at CiBase (add Geo.ts)\r\nimport { reactive } from 'vue'\r\nimport { Message } from '@/services/CiMqttClient'\r\nimport { CiBaseController, IBase } from './CiBaseController'\r\n\r\nexport interface Socket2 extends IBase {\r\n  iSocket2State: number;\r\n  type: string;\r\n  battery?: string;\r\n  textUpper?: string;\r\n  textLower?: string;\r\n  textFooter?: string;\r\n  pubPayloadLower?: string;\r\n  // Note: default pubPayload means pubPayloadUpper!\r\n}\r\n\r\nexport class CiSocket2Controller extends CiBaseController {\r\n  public sockets2: Array<Socket2> = reactive(\r\n    [\r\n      {\r\n        type: 'delock11826', // e1603=IKEA\r\n        id: 's1-3113',\r\n        name: 's1',\r\n        iSocket2State: -99, // 0x9999FF,\r\n        textUpper: 'ON',\r\n        textLower: 'OFF',\r\n        // textFooter: 'socket_s1',\r\n        subTopic: 'ip/h/steckdose/s1/RESULT',\r\n        pubTopic: 'ip/h/steckdose/s1/cmnd/POWER',\r\n        pubPayload: 'ON',\r\n        pubPayloadLower: 'OFF'\r\n      },\r\n      {\r\n        type: 'delock11826', // e1603=IKEA\r\n        id: 's2-4497',\r\n        name: 's2',\r\n        iSocket2State: -99, // 0x9999FF,\r\n        textUpper: 'ON',\r\n        textLower: 'OFF',\r\n        // textFooter: 'socket_s2',\r\n        subTopic: 'ip/h/steckdose/s2/RESULT',\r\n        pubTopic: 'ip/h/steckdose/s2/cmnd/POWER',\r\n        pubPayload: 'ON',\r\n        pubPayloadLower: 'OFF'\r\n      }\r\n\r\n      /*\r\n      {\r\n        id: 'socket1',\r\n        name: 'Socket2_1',\r\n        iSocket2State: -99,\r\n        type: 'delock11826',\r\n        // textUpper: 'ON',\r\n        // textLower: 'OFF',\r\n        textFooter: '--Footer1--',\r\n        subTopic: 'ci/socket2/1/ret ci/socket2/set',\r\n        pubTopic: 'ci/socket2/1/set/socket2 ci/socket2/set',\r\n        pubPayload: '{\"POWER\":\"1\"}',\r\n        pubPayloadLower: '{\"POWER\":\"0\"}'\r\n      },\r\n      {\r\n        id: 'socket2',\r\n        name: 'Socket2_2',\r\n        iSocket2State: -99,\r\n        type: 'delock11826', // e1603=IKEA\r\n        textUpper: 'ON',\r\n        textLower: 'OFF',\r\n        textFooter: '==Footer2==',\r\n        subTopic: 'ci/socket2/2/ret ci/socket2/set',\r\n        pubTopic: 'ci/socket2/2/set/socket2 ci/socket2/set',\r\n        pubPayload: '{\"POWER\":\"ON\"}',\r\n        pubPayloadLower: '{\"POWER\":\"OFF\"}'\r\n      }\r\n      */\r\n    ]\r\n  );\r\n\r\n  public onMessage (message: Message): void {\r\n    this.sockets2.forEach(socket2 => {\r\n      const aSubTopic = socket2.subTopic.split(' ')\r\n      if (aSubTopic.includes(message.topic)) {\r\n        // ---socket2 found ------------------------------------\r\n        if (socket2.type === 'delock11826') {\r\n          const aPayload = JSON.parse(message.payload)\r\n          if ((aPayload.POWER === 'ON') || (aPayload.POWER === '1')) socket2.iSocket2State = -1\r\n          else {\r\n            if ((aPayload.POWER === 'OFF') || (aPayload.POWER === '0')) socket2.iSocket2State = -2\r\n            else { socket2.iSocket2State = -9 }\r\n          }\r\n        }\r\n        // ---end socket2 found---------------------------------\r\n      }\r\n    })\r\n  }\r\n\r\n  public publishCi (topic: string, payload: string): void {\r\n    // console.log('CiSocket1Controller:publishCi:', '-t ' + topic + ' -m ' + payload)\r\n    this.publish(topic, payload, false, 0).catch((e) => { console.error('CiSocketController: ERROR:', e) })\r\n  }\r\n}\r\n\r\nexport const ciSocket2Controller = new CiSocket2Controller()\r\n"]}]}