{"remainingRequest":"G:\\work3\\vue\\haus3\\node_modules\\thread-loader\\dist\\cjs.js!G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js??ref--13-2!G:\\work3\\vue\\haus3\\src\\controller\\CiMqttLastXController.ts","dependencies":[{"path":"G:\\work3\\vue\\haus3\\src\\controller\\CiMqttLastXController.ts","mtime":1676302606652},{"path":"G:\\work3\\vue\\haus3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSAidHNsaWIiOw0KaW1wb3J0IHsgY2lNcXR0Q2xpZW50SW5zdGFuY2UgfSBmcm9tICdAL3NlcnZpY2VzL0NpTXF0dENsaWVudEluc3RhbmNlJzsNCmltcG9ydCB7IG1lc3NhZ2VzMiwgYWRkTWVzc2FnZSB9IGZyb20gJ0Avc3RvcmUvQ2lNZXNzYWdlU3RvcmUnOw0KaW1wb3J0IHsgY29tcHV0ZWQgfSBmcm9tICd2dWUnOw0KaW1wb3J0IHsgQ2lCYXNlQ29udHJvbGxlciB9IGZyb20gJy4vQ2lCYXNlQ29udHJvbGxlcic7DQp2YXIgQ2lNcXR0TGFzdFhDb250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgew0KICAgIF9fZXh0ZW5kcyhDaU1xdHRMYXN0WENvbnRyb2xsZXIsIF9zdXBlcik7DQogICAgZnVuY3Rpb24gQ2lNcXR0TGFzdFhDb250cm9sbGVyKCkgew0KICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOw0KICAgICAgICBfdGhpcy5tZXNzYWdlczIgPSBtZXNzYWdlczI7DQogICAgICAgIF90aGlzLmFkZE1lc3NhZ2UgPSBhZGRNZXNzYWdlOw0KICAgICAgICByZXR1cm4gX3RoaXM7DQogICAgfQ0KICAgIENpTXF0dExhc3RYQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0RGF0ZVRpbWUgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpOw0KICAgICAgICB2YXIgczEgPSAnJzsNCiAgICAgICAgaWYgKG5vdy5nZXREYXRlKCkgPCAxMCkNCiAgICAgICAgICAgIHMxICs9ICcwJzsNCiAgICAgICAgczEgKz0gbm93LmdldERhdGUoKTsNCiAgICAgICAgczEgKz0gJy4nOw0KICAgICAgICBpZiAobm93LmdldE1vbnRoKCkgPCA5KQ0KICAgICAgICAgICAgczEgKz0gJzAnOw0KICAgICAgICBzMSArPSAoMSArIG5vdy5nZXRNb250aCgpKTsNCiAgICAgICAgczEgKz0gJy4nOw0KICAgICAgICBzMSArPSBub3cuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgczEgKz0gJyAnOw0KICAgICAgICBpZiAobm93LmdldEhvdXJzKCkgPCAxMCkNCiAgICAgICAgICAgIHMxICs9ICcwJzsNCiAgICAgICAgczEgKz0gbm93LmdldEhvdXJzKCk7DQogICAgICAgIHMxICs9ICc6JzsNCiAgICAgICAgaWYgKG5vdy5nZXRNaW51dGVzKCkgPCAxMCkNCiAgICAgICAgICAgIHMxICs9ICcwJzsNCiAgICAgICAgczEgKz0gbm93LmdldE1pbnV0ZXMoKTsNCiAgICAgICAgczEgKz0gJzonOw0KICAgICAgICBpZiAobm93LmdldFNlY29uZHMoKSA8IDEwKQ0KICAgICAgICAgICAgczEgKz0gJzAnOw0KICAgICAgICBzMSArPSBub3cuZ2V0U2Vjb25kcygpOw0KICAgICAgICByZXR1cm4gczE7DQogICAgfTsNCiAgICBDaU1xdHRMYXN0WENvbnRyb2xsZXIucHJvdG90eXBlLm9uTWVzc2FnZSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7DQogICAgICAgIHZhciBtZXNzYWdlMiA9IHsNCiAgICAgICAgICAgIHRvcGljOiBtZXNzYWdlLnRvcGljLA0KICAgICAgICAgICAgcGF5bG9hZDogbWVzc2FnZS5wYXlsb2FkLA0KICAgICAgICAgICAgcmV0YWluOiBtZXNzYWdlLnJldGFpbiwNCiAgICAgICAgICAgIHFvczogbWVzc2FnZS5xb3MsDQogICAgICAgICAgICBkYXRldGltZTogdGhpcy5nZXREYXRlVGltZSgpDQogICAgICAgICAgICAvLyBkYXRlOiBub3cuZ2V0RGF0ZSgpICsgJy4nICsgKG5vdy5nZXRNb250aCgpICsgMSkgKyAnLicgKyBub3cuZ2V0RnVsbFllYXIoKSwNCiAgICAgICAgICAgIC8vIGRhdGU6IFZ1ZS5maWx0ZXIoJ0RELk1NLllZWVknKShub3cpLA0KICAgICAgICAgICAgLy8gdGltZTogbm93LmdldEhvdXJzKCkgKyAnOicgKyBub3cuZ2V0TWludXRlcygpICsgJzonICsgbm93LmdldFNlY29uZHMoKQ0KICAgICAgICB9Ow0KICAgICAgICB0aGlzLmFkZE1lc3NhZ2UobWVzc2FnZTIpOw0KICAgICAgICAvLyBjb25zb2xlLmxvZygnTXF0dExhc3RYQ29udHJvbGxlci50cycsICdSZWNlaXZlZCAnICsgbWVzc2FnZS50b3BpYykNCiAgICB9Ow0KICAgIENpTXF0dExhc3RYQ29udHJvbGxlci5wcm90b3R5cGUuaXNTdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHJldHVybiBjb21wdXRlZChmdW5jdGlvbiAoKSB7IHJldHVybiBjaU1xdHRDbGllbnRJbnN0YW5jZS5tcXR0U3RhdGUuY29ubmVjdGVkICYmIGNpTXF0dENsaWVudEluc3RhbmNlLm1xdHRTdWJzY3JpcHRpb24uc3Vic2NyaWJlZDsgfSk7DQogICAgfTsNCiAgICByZXR1cm4gQ2lNcXR0TGFzdFhDb250cm9sbGVyOw0KfShDaUJhc2VDb250cm9sbGVyKSk7DQpleHBvcnQgeyBDaU1xdHRMYXN0WENvbnRyb2xsZXIgfTsNCmV4cG9ydCB2YXIgY2lNcXR0TGFzdFhDb250cm9sbGVyID0gbmV3IENpTXF0dExhc3RYQ29udHJvbGxlcigpOw0K"},{"version":3,"file":"G:\\work3\\vue\\haus3\\src\\controller\\CiMqttLastXController.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus3\\src\\controller\\CiMqttLastXController.ts"],"names":[],"mappings":";AAEA,OAAO,EAAE,oBAAoB,EAAE,MAAM,iCAAiC,CAAA;AACtE,OAAO,EAAY,SAAS,EAAE,UAAU,EAAE,MAAM,wBAAwB,CAAA;AACxE,OAAO,EAAE,QAAQ,EAAe,MAAM,KAAK,CAAA;AAC3C,OAAO,EAAE,gBAAgB,EAAE,MAAM,oBAAoB,CAAA;AAErD;IAA2C,yCAAgB;IAIzD;QAAA,YACE,iBAAO,SAGR;QAFC,KAAI,CAAC,SAAS,GAAG,SAAS,CAAA;QAC1B,KAAI,CAAC,UAAU,GAAG,UAAU,CAAA;;IAC9B,CAAC;IAEM,2CAAW,GAAlB;QACE,IAAM,GAAG,GAAG,IAAI,IAAI,EAAE,CAAA;QACtB,IAAI,EAAE,GAAG,EAAE,CAAA;QACX,IAAI,GAAG,CAAC,OAAO,EAAE,GAAG,EAAE;YAAE,EAAE,IAAI,GAAG,CAAA;QACjC,EAAE,IAAI,GAAG,CAAC,OAAO,EAAE,CAAA;QACnB,EAAE,IAAI,GAAG,CAAA;QACT,IAAI,GAAG,CAAC,QAAQ,EAAE,GAAG,CAAC;YAAE,EAAE,IAAI,GAAG,CAAA;QACjC,EAAE,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAA;QAC1B,EAAE,IAAI,GAAG,CAAA;QACT,EAAE,IAAI,GAAG,CAAC,WAAW,EAAE,CAAA;QACvB,EAAE,IAAI,GAAG,CAAA;QACT,IAAI,GAAG,CAAC,QAAQ,EAAE,GAAG,EAAE;YAAE,EAAE,IAAI,GAAG,CAAA;QAClC,EAAE,IAAI,GAAG,CAAC,QAAQ,EAAE,CAAA;QACpB,EAAE,IAAI,GAAG,CAAA;QACT,IAAI,GAAG,CAAC,UAAU,EAAE,GAAG,EAAE;YAAE,EAAE,IAAI,GAAG,CAAA;QACpC,EAAE,IAAI,GAAG,CAAC,UAAU,EAAE,CAAA;QACtB,EAAE,IAAI,GAAG,CAAA;QACT,IAAI,GAAG,CAAC,UAAU,EAAE,GAAG,EAAE;YAAE,EAAE,IAAI,GAAG,CAAA;QACpC,EAAE,IAAI,GAAG,CAAC,UAAU,EAAE,CAAA;QACtB,OAAO,EAAE,CAAA;IACX,CAAC;IAEM,yCAAS,GAAhB,UAAkB,OAAgB;QAChC,IAAM,QAAQ,GAAa;YACzB,KAAK,EAAE,OAAO,CAAC,KAAK;YACpB,OAAO,EAAE,OAAO,CAAC,OAAO;YACxB,MAAM,EAAE,OAAO,CAAC,MAAM;YACtB,GAAG,EAAE,OAAO,CAAC,GAAG;YAChB,QAAQ,EAAE,IAAI,CAAC,WAAW,EAAE;YAC5B,8EAA8E;YAC9E,uCAAuC;YACvC,yEAAyE;SAC1E,CAAA;QACD,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAA;QACzB,qEAAqE;IACvE,CAAC;IAEM,2CAAW,GAAlB;QACE,OAAO,QAAQ,CAAC,cAAM,OAAA,oBAAoB,CAAC,SAAS,CAAC,SAAS,IAAI,oBAAoB,CAAC,gBAAgB,CAAC,UAAU,EAA5F,CAA4F,CAAC,CAAA;IACrH,CAAC;IACH,4BAAC;AAAD,CAAC,AAlDD,CAA2C,gBAAgB,GAkD1D;;AAED,MAAM,CAAC,IAAM,qBAAqB,GAAG,IAAI,qBAAqB,EAAE,CAAA","sourcesContent":["// ______CiMqttLastXController.ts_______________________________\r\nimport { Message } from '@/services/CiMqttClient'\r\nimport { ciMqttClientInstance } from '@/services/CiMqttClientInstance'\r\nimport { Message2, messages2, addMessage } from '@/store/CiMessageStore'\r\nimport { computed, ComputedRef } from 'vue'\r\nimport { CiBaseController } from './CiBaseController'\r\n\r\nexport class CiMqttLastXController extends CiBaseController {\r\n  private messages2;\r\n  private addMessage;\r\n\r\n  constructor () {\r\n    super()\r\n    this.messages2 = messages2\r\n    this.addMessage = addMessage\r\n  }\r\n\r\n  public getDateTime (): string {\r\n    const now = new Date()\r\n    let s1 = ''\r\n    if (now.getDate() < 10) s1 += '0'\r\n    s1 += now.getDate()\r\n    s1 += '.'\r\n    if (now.getMonth() < 9) s1 += '0'\r\n    s1 += (1 + now.getMonth())\r\n    s1 += '.'\r\n    s1 += now.getFullYear()\r\n    s1 += ' '\r\n    if (now.getHours() < 10) s1 += '0'\r\n    s1 += now.getHours()\r\n    s1 += ':'\r\n    if (now.getMinutes() < 10) s1 += '0'\r\n    s1 += now.getMinutes()\r\n    s1 += ':'\r\n    if (now.getSeconds() < 10) s1 += '0'\r\n    s1 += now.getSeconds()\r\n    return s1\r\n  }\r\n\r\n  public onMessage (message: Message): void {\r\n    const message2: Message2 = {\r\n      topic: message.topic,\r\n      payload: message.payload,\r\n      retain: message.retain,\r\n      qos: message.qos,\r\n      datetime: this.getDateTime()\r\n      // date: now.getDate() + '.' + (now.getMonth() + 1) + '.' + now.getFullYear(),\r\n      // date: Vue.filter('DD.MM.YYYY')(now),\r\n      // time: now.getHours() + ':' + now.getMinutes() + ':' + now.getSeconds()\r\n    }\r\n    this.addMessage(message2)\r\n    // console.log('MqttLastXController.ts', 'Received ' + message.topic)\r\n  }\r\n\r\n  public isSubscribe (): ComputedRef<boolean> {\r\n    return computed(() => ciMqttClientInstance.mqttState.connected && ciMqttClientInstance.mqttSubscription.subscribed)\r\n  }\r\n}\r\n\r\nexport const ciMqttLastXController = new CiMqttLastXController()\r\n"]}]}