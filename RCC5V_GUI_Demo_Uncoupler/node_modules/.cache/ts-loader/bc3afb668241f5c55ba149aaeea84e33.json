{"remainingRequest":"G:\\work3\\vue\\haus3\\node_modules\\thread-loader\\dist\\cjs.js!G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js??ref--13-2!G:\\work3\\vue\\haus3\\src\\controller\\CiSmsStatus1Controller.ts","dependencies":[{"path":"G:\\work3\\vue\\haus3\\src\\controller\\CiSmsStatus1Controller.ts","mtime":1678876807178},{"path":"G:\\work3\\vue\\haus3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\work3\\vue\\haus3\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSAidHNsaWIiOw0KLy8gX19fX19fQ2lTbXNTdGF0dXMxQ29udHJvbGxlci50c19fX19fX19fX19fX19fX2toYXJ0aW5nZXJfX19fXw0KLy8gMjAyMy0wMy0xNTogbmV3DQppbXBvcnQgeyByZWFjdGl2ZSB9IGZyb20gJ3Z1ZSc7DQppbXBvcnQgeyBDaUJhc2VDb250cm9sbGVyIH0gZnJvbSAnLi9DaUJhc2VDb250cm9sbGVyJzsNCnZhciBDaVNtc1N0YXR1czFDb250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgew0KICAgIF9fZXh0ZW5kcyhDaVNtc1N0YXR1czFDb250cm9sbGVyLCBfc3VwZXIpOw0KICAgIGZ1bmN0aW9uIENpU21zU3RhdHVzMUNvbnRyb2xsZXIoKSB7DQogICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOw0KICAgICAgICBfdGhpcy56Mk1zdGF0dXMxcyA9IHJlYWN0aXZlKFsNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZDogJ3Ntc3N0YXR1czEnLA0KICAgICAgICAgICAgICAgIG5hbWU6ICdTdGF0dXMgR1NNIE1vZGVtJywNCiAgICAgICAgICAgICAgICBpU21zU3RhdHVzU3RhdGU6IC05OSwNCiAgICAgICAgICAgICAgICB0ZXh0VXBwZXI6ICdNb2RlbSBTdGF0dXMnLA0KICAgICAgICAgICAgICAgIHRleHRNaWRkbGU6ICdTSU0gU3RhdHVzJywNCiAgICAgICAgICAgICAgICB0ZXh0TG93ZXI6ICdHVVRIQUJFTicsDQogICAgICAgICAgICAgICAgc3ViVG9waWM6ICdzbXMvY21kL3JldC9tb2R1bGUgc21zL2NtZC9yZXQvc2ltIHNtcy9jbWQvcmV0L2NyZWRpdCcsDQogICAgICAgICAgICAgICAgcHViVG9waWM6ICdzbXMvY21kL2dldCcsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZDogJ21vZHVsZScsDQogICAgICAgICAgICAgICAgcHViVG9waWMyOiAnc21zL2NtZC9nZXQnLA0KICAgICAgICAgICAgICAgIHB1YlBheWxvYWQyOiAnc2ltJywNCiAgICAgICAgICAgICAgICBwdWJUb3BpYzM6ICdzbXMvY21kL2dldCcsDQogICAgICAgICAgICAgICAgcHViUGF5bG9hZDM6ICdjcmVkaXQnDQogICAgICAgICAgICB9DQogICAgICAgIF0pOw0KICAgICAgICAvLyBfX19fX19fX19zdGF0ZSBjb25zdGFudHNfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0KICAgICAgICBfdGhpcy5tYXNrU21zTW9kdWxlID0gMHgwMTsNCiAgICAgICAgX3RoaXMubWFza1Ntc1NpbSA9IDB4MDI7DQogICAgICAgIF90aGlzLm1hc2tTbXNDcmVkaXQgPSAweDA0Ow0KICAgICAgICBfdGhpcy5tYXNrU21zVmFsaWRNb2R1bGUgPSAweDEwOw0KICAgICAgICBfdGhpcy5tYXNrU21zVmFsaWRTaW0gPSAweDIwOw0KICAgICAgICBfdGhpcy5tYXNrU21zVmFsaWRDcmVkaXQgPSAweDQwOw0KICAgICAgICBfdGhpcy5tYXNrU21zVmFsaWRBbnkgPSAweDcwOw0KICAgICAgICByZXR1cm4gX3RoaXM7DQogICAgfQ0KICAgIC8vIF9fX19fX19fX3JlYWN0IG9uIGluY29tbWluZyBNUVRUIG1lc3NhZ2VzX19fX19fX19fX19fX19fX19fDQogICAgQ2lTbXNTdGF0dXMxQ29udHJvbGxlci5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHsNCiAgICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgICAgdGhpcy56Mk1zdGF0dXMxcy5mb3JFYWNoKGZ1bmN0aW9uIChzbXNzdGF0dXMxKSB7DQogICAgICAgICAgICB2YXIgYVN1YlRvcGljID0gc21zc3RhdHVzMS5zdWJUb3BpYy5zcGxpdCgnICcpOw0KICAgICAgICAgICAgaWYgKGFTdWJUb3BpYy5pbmNsdWRlcyhtZXNzYWdlLnRvcGljKSkgew0KICAgICAgICAgICAgICAgIC8vID09PT09PT09c21zc3RhdHVzMSBmb3VuZD09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogICAgICAgICAgICAgICAgaWYgKHNtc3N0YXR1czEuaVNtc1N0YXR1c1N0YXRlIDwgMCkNCiAgICAgICAgICAgICAgICAgICAgc21zc3RhdHVzMS5pU21zU3RhdHVzU3RhdGUgPSAwOw0KICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnRvcGljLmluY2x1ZGVzKCcvcmV0L21vZHVsZScpKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIC0tLS0tLW1vZHVsZSBzdGF0ZS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF5bG9hZDogeyJkZXZpY2UiOiIvZGV2L3R0eVVTQl9Nb2RlbSIsIm1vZHVsZSI6dHJ1ZSwicHJvZHVjdCI6IlNJTTgwOCBSMTQuMTgifQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFQYXlsb2FkID0gSlNPTi5wYXJzZShtZXNzYWdlLnBheWxvYWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFQYXlsb2FkLm1vZHVsZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc3N0YXR1czEudGV4dEZvb3RlciA9IGFQYXlsb2FkLmRldmljZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbXNzdGF0dXMxLmlTbXNTdGF0dXNTdGF0ZSB8PSBfdGhpcy5tYXNrU21zTW9kdWxlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc21zc3RhdHVzMS50ZXh0Rm9vdGVyID0gJ05vIGRldmljZSc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc21zc3RhdHVzMS5pU21zU3RhdHVzU3RhdGUgJj0gfl90aGlzLm1hc2tTbXNNb2R1bGU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBzbXNzdGF0dXMxLmlTbXNTdGF0dXNTdGF0ZSB8PSBfdGhpcy5tYXNrU21zVmFsaWRNb2R1bGU7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnaV89Jywgc21zc3RhdHVzMS5pU21zU3RhdHVzU3RhdGUsICcgLXQgJywgbWVzc2FnZS50b3BpYywgJ3BheTogJywgYVBheWxvYWQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgc21zc3RhdHVzMS5pU21zU3RhdHVzU3RhdGUgJj0gfl90aGlzLm1hc2tTbXNWYWxpZE1vZHVsZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS50b3BpYy5pbmNsdWRlcygnL3JldC9zaW0nKSkgew0KICAgICAgICAgICAgICAgICAgICAvLyAtLS0tLS1zaW0gc3RhdGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBheWxvYWQ6IHsicHJvdmlkZXIiOiJULU1vYmlsZSBBIiwic2ltIjp0cnVlLCJyZXN1bHQiOiJefitDT1BTOiAwLDAsJ1QtTW9iaWxlIEEnXn5efk9LXn4ifQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFQYXlsb2FkID0gSlNPTi5wYXJzZShtZXNzYWdlLnBheWxvYWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFQYXlsb2FkLnNpbSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc3N0YXR1czEudGV4dEZvb3RlciA9IGFQYXlsb2FkLnByb3ZpZGVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc3N0YXR1czEuaVNtc1N0YXR1c1N0YXRlIHw9IF90aGlzLm1hc2tTbXNTaW07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbXNzdGF0dXMxLnRleHRGb290ZXIgPSAnTm8gcHJvdmlkZXInOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc3N0YXR1czEuaVNtc1N0YXR1c1N0YXRlICY9IH5fdGhpcy5tYXNrU21zU2ltOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgc21zc3RhdHVzMS5pU21zU3RhdHVzU3RhdGUgfD0gX3RoaXMubWFza1Ntc1ZhbGlkU2ltOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgc21zc3RhdHVzMS5pU21zU3RhdHVzU3RhdGUgJj0gfl90aGlzLm1hc2tTbXNWYWxpZFNpbTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS50b3BpYy5pbmNsdWRlcygnL3JldC9jcmVkaXQnKSkgew0KICAgICAgICAgICAgICAgICAgICAvLyAtLS0tLS1zaW0gc3RhdGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBheWxvYWQ6IHsiZXVybyI6MzMuMjV9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVBheWxvYWQgPSBKU09OLnBhcnNlKG1lc3NhZ2UucGF5bG9hZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVBheWxvYWQuZXVybyA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc21zc3RhdHVzMS50ZXh0Rm9vdGVyID0gIiIgKyBhUGF5bG9hZC5ldXJvOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc3N0YXR1czEuaVNtc1N0YXR1c1N0YXRlIHw9IF90aGlzLm1hc2tTbXNDcmVkaXQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbXNzdGF0dXMxLnRleHRGb290ZXIgPSAnTm8gSW5mbyc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc21zc3RhdHVzMS5pU21zU3RhdHVzU3RhdGUgJj0gfl90aGlzLm1hc2tTbXNDcmVkaXQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBzbXNzdGF0dXMxLmlTbXNTdGF0dXNTdGF0ZSB8PSBfdGhpcy5tYXNrU21zVmFsaWRDcmVkaXQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzbXNzdGF0dXMxLmlTbXNTdGF0dXNTdGF0ZSAmPSB+X3RoaXMubWFza1Ntc1ZhbGlkQ3JlZGl0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSAvLyA9PT1FTkQgb2Ygc21zc3RhdHVzMSBmb3VuZD09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIC8vIF9fX19fX19fX3B1Ymxpc2ggYSBNUVRUIG1lc3NhZ2VfX19fX19fX19fX19fX19fX19fX19fX19fX19fDQogICAgQ2lTbXNTdGF0dXMxQ29udHJvbGxlci5wcm90b3R5cGUucHVibGlzaENpID0gZnVuY3Rpb24gKHRvcGljLCBwYXlsb2FkKSB7DQogICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaVNtc1N0YXR1czExQ29udHJvbGxlcjpwdWJsaXNoQ2k6JywgJy10ICcgKyB0b3BpYyArICcgLW0gJyArIHBheWxvYWQpDQogICAgICAgIHRoaXMucHVibGlzaCh0b3BpYywgcGF5bG9hZCwgZmFsc2UsIDApLmNhdGNoKGZ1bmN0aW9uIChlKSB7IGNvbnNvbGUuZXJyb3IoJ0NpU21zU3RhdHVzMUNvbnRyb2xsZXI6IEVSUk9SOicsIGUpOyB9KTsNCiAgICB9Ow0KICAgIHJldHVybiBDaVNtc1N0YXR1czFDb250cm9sbGVyOw0KfShDaUJhc2VDb250cm9sbGVyKSk7DQpleHBvcnQgeyBDaVNtc1N0YXR1czFDb250cm9sbGVyIH07DQpleHBvcnQgdmFyIGNpU21zU3RhdHVzMUNvbnRyb2xsZXIgPSBuZXcgQ2lTbXNTdGF0dXMxQ29udHJvbGxlcigpOw0K"},{"version":3,"file":"G:\\work3\\vue\\haus3\\src\\controller\\CiSmsStatus1Controller.ts","sourceRoot":"","sources":["G:\\work3\\vue\\haus3\\src\\controller\\CiSmsStatus1Controller.ts"],"names":[],"mappings":"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","sourcesContent":["// ______CiSmsStatus1Controller.ts_______________khartinger_____\r\n// 2023-03-15: new\r\nimport { reactive } from 'vue'\r\nimport { Message } from '@/services/CiMqttClient'\r\nimport { CiBaseController, IBase } from './CiBaseController'\r\n\r\nexport interface SmsStatus1 extends IBase {\r\n  // ---------mandatory-----------------------------------------\r\n  iSmsStatusState: number;\r\n  // ---------optional------------------------------------------\r\n  textUpper?: string;\r\n  textMiddle?: string;\r\n  textLower?: string;\r\n  textFooter?: string;\r\n  pubTopic2?: string;\r\n  pubPayload2?: string;\r\n  pubTopic3?: string;\r\n  pubPayload3?: string;\r\n  // Note: default pubPayload means pubPayloadUpper!\r\n}\r\n\r\nexport class CiSmsStatus1Controller extends CiBaseController {\r\n  public z2Mstatus1s: Array<SmsStatus1> = reactive(\r\n    [\r\n      {\r\n        id: 'smsstatus1',\r\n        name: 'Status GSM Modem',\r\n        iSmsStatusState: -99,\r\n        textUpper: 'Modem Status',\r\n        textMiddle: 'SIM Status',\r\n        textLower: 'GUTHABEN',\r\n        subTopic: 'sms/cmd/ret/module sms/cmd/ret/sim sms/cmd/ret/credit',\r\n        pubTopic: 'sms/cmd/get',\r\n        pubPayload: 'module',\r\n        pubTopic2: 'sms/cmd/get',\r\n        pubPayload2: 'sim',\r\n        pubTopic3: 'sms/cmd/get',\r\n        pubPayload3: 'credit'\r\n      }\r\n    ]\r\n  );\r\n\r\n  // _________state constants___________________________________\r\n  public maskSmsModule = 0x01;\r\n  public maskSmsSim = 0x02;\r\n  public maskSmsCredit = 0x04;\r\n  public maskSmsValidModule = 0x10;\r\n  public maskSmsValidSim = 0x20;\r\n  public maskSmsValidCredit = 0x40;\r\n  public maskSmsValidAny = 0x70;\r\n\r\n  // _________react on incomming MQTT messages__________________\r\n  public onMessage (message: Message): void {\r\n    this.z2Mstatus1s.forEach(smsstatus1 => {\r\n      const aSubTopic = smsstatus1.subTopic.split(' ')\r\n      if (aSubTopic.includes(message.topic)) {\r\n        // ========smsstatus1 found=============================\r\n        if (smsstatus1.iSmsStatusState < 0) smsstatus1.iSmsStatusState = 0\r\n        if (message.topic.includes('/ret/module')) {\r\n          // ------module state---------------------------------\r\n          try {\r\n            // payload: {\"device\":\"/dev/ttyUSB_Modem\",\"module\":true,\"product\":\"SIM808 R14.18\"}\r\n            const aPayload = JSON.parse(message.payload)\r\n            if (aPayload.module) {\r\n              smsstatus1.textFooter = aPayload.device\r\n              smsstatus1.iSmsStatusState |= this.maskSmsModule\r\n            } else {\r\n              smsstatus1.textFooter = 'No device'\r\n              smsstatus1.iSmsStatusState &= ~this.maskSmsModule\r\n            }\r\n            smsstatus1.iSmsStatusState |= this.maskSmsValidModule\r\n            console.log('i_=', smsstatus1.iSmsStatusState, ' -t ', message.topic, 'pay: ', aPayload)\r\n          } catch (error) {\r\n            smsstatus1.iSmsStatusState &= ~this.maskSmsValidModule\r\n          }\r\n        }\r\n        if (message.topic.includes('/ret/sim')) {\r\n          // ------sim state------------------------------------\r\n          try {\r\n            // payload: {\"provider\":\"T-Mobile A\",\"sim\":true,\"result\":\"^~+COPS: 0,0,'T-Mobile A'^~^~OK^~\"}\r\n            const aPayload = JSON.parse(message.payload)\r\n            if (aPayload.sim) {\r\n              smsstatus1.textFooter = aPayload.provider\r\n              smsstatus1.iSmsStatusState |= this.maskSmsSim\r\n            } else {\r\n              smsstatus1.textFooter = 'No provider'\r\n              smsstatus1.iSmsStatusState &= ~this.maskSmsSim\r\n            }\r\n            smsstatus1.iSmsStatusState |= this.maskSmsValidSim\r\n          } catch (error) {\r\n            smsstatus1.iSmsStatusState &= ~this.maskSmsValidSim\r\n          }\r\n        }\r\n        if (message.topic.includes('/ret/credit')) {\r\n          // ------sim state------------------------------------\r\n          try {\r\n            // payload: {\"euro\":33.25}\r\n            const aPayload = JSON.parse(message.payload)\r\n            if (aPayload.euro >= 0) {\r\n              smsstatus1.textFooter = `${aPayload.euro}`\r\n              smsstatus1.iSmsStatusState |= this.maskSmsCredit\r\n            } else {\r\n              smsstatus1.textFooter = 'No Info'\r\n              smsstatus1.iSmsStatusState &= ~this.maskSmsCredit\r\n            }\r\n            smsstatus1.iSmsStatusState |= this.maskSmsValidCredit\r\n          } catch (error) {\r\n            smsstatus1.iSmsStatusState &= ~this.maskSmsValidCredit\r\n          }\r\n        }\r\n      } // ===END of smsstatus1 found===========================\r\n    })\r\n  }\r\n\r\n  // _________publish a MQTT message____________________________\r\n  public publishCi (topic: string, payload: string): void {\r\n    // console.log('CiSmsStatus11Controller:publishCi:', '-t ' + topic + ' -m ' + payload)\r\n    this.publish(topic, payload, false, 0).catch((e) => { console.error('CiSmsStatus1Controller: ERROR:', e) })\r\n  }\r\n}\r\n\r\nexport const ciSmsStatus1Controller = new CiSmsStatus1Controller()\r\n"]}]}